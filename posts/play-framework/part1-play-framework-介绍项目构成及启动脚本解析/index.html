<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Play frameworkæºç è§£æ Part1: Play framework ä»‹ç»ã€é¡¹ç›®æ„æˆåŠå¯åŠ¨è„šæœ¬è§£æ | 404 NOT FOUND</title><meta name=keywords content="program,backend"><meta name=description content='æ³¨ï¼šæœ¬ç³»åˆ—æ–‡ç« æ‰€ç”¨playç‰ˆæœ¬ä¸º1.2.6

ä»‹ç»
Play frameworkæ˜¯ä¸ªè½»é‡çº§çš„RESTfulæ¡†æ¶ï¼Œè‡´åŠ›äºè®©javaç¨‹åºå‘˜å®ç°å¿«é€Ÿé«˜æ•ˆå¼€å‘ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ä¼˜åŠ¿ï¼š

çƒ­åŠ è½½ã€‚åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä¿®æ”¹ä¼šåŠæ—¶ç”Ÿæ•ˆã€‚
æŠ›å¼ƒxmlé…ç½®æ–‡ä»¶ã€‚çº¦å®šå¤§äºé…ç½®ã€‚
æ”¯æŒå¼‚æ­¥ç¼–ç¨‹
æ— çŠ¶æ€mvcæ¡†æ¶ï¼Œæ‹“å±•æ€§è‰¯å¥½
ç®€å•çš„è·¯ç”±è®¾ç½®

è¿™é‡Œé™„ä¸ŠPlay frameworkçš„æ–‡æ¡£åœ°å€ï¼Œå®˜æ–¹æœ‰æ›´ä¸ºè¯¦å°½çš„åŠŸèƒ½å™è¿°ã€‚Play frameworkæ–‡æ¡£


é¡¹ç›®æ„æˆ
play frameworkçš„åˆå§‹åŒ–éå¸¸ç®€å•ï¼Œåªè¦ä¸‹è½½äº†playçš„è½¯ä»¶åŒ…åï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œplay new xxxå³å¯åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ã€‚
è‡ªåŠ¨ç”Ÿæˆçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š

è¿è¡Œplayç¨‹åºä¹Ÿéå¸¸ç®€å•ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹ä½¿ç”¨
play run
å³å¯è¿è¡Œã€‚

å¯åŠ¨è„šæœ¬è§£æ
play frameworkè½¯ä»¶åŒ…ç›®å½•
ä¸ºäº†æ›´å¥½çš„äº†è§£play frameworkçš„è¿ä½œåŸç†ï¼Œæˆ‘ä»¬æ¥ä»play frameworkçš„å¯åŠ¨è„šæœ¬å¼€å§‹åˆ†æï¼Œåˆ†æå¯åŠ¨è„šæœ¬æœ‰åŠ©äºæˆ‘ä»¬äº†è§£play frameworkçš„è¿è¡Œè¿‡ç¨‹ã€‚
playçš„å¯åŠ¨è„šæœ¬æ˜¯ä½¿ç”¨pythonç¼–å†™çš„ï¼Œè„šæœ¬çš„å…¥å£ä¸ºplayè½¯ä»¶åŒ…æ ¹ç›®å½•ä¸‹çš„playæ–‡ä»¶,ä¸‹é¢æˆ‘ä»¬å°†ä»playè¿™ä¸ªè„šæœ¬çš„ä¸»å…¥å£å¼€å§‹åˆ†æã€‚

playè„šæœ¬è§£æ
playè„šæœ¬åœ¨å¼€å¤´å¼•å…¥äº†3ä¸ªç±»ï¼Œåˆ†åˆ«ä¸ºplay.cmdloader,play.application,play.utilsï¼Œä»æ·»åŠ çš„ç³»ç»Ÿå‚æ•°ä¸­å¯ä»¥çœ‹å‡ºplayå¯åŠ¨è„šæœ¬çš„å­˜æ”¾è·¯å¾„ä¸º framework/pym
cmdloader.pyçš„ä¸»è¦ä½œç”¨ä¸ºåŠ è½½framework/pym/commandsä¸‹çš„å„ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨äºä¹‹åå¯¹å‘½ä»¤å‚æ•°çš„è§£é‡Šè¿è¡Œ
application.pyçš„ä¸»è¦ä½œç”¨ä¸ºè§£æé¡¹ç›®è·¯å¾„ä¸‹conf/ä¸­çš„é…ç½®æ–‡ä»¶ã€åŠ è½½æ¨¡å—ã€æ‹¼æ¥æœ€åè¿è¡Œçš„javaå‘½ä»¤
sys.path.append(os.path.join(os.path.dirname(os.path.realpath(sys.argv[0])), &#39;framework&#39;, &#39;pym&#39;))

from play.cmdloader import CommandLoader
from play.application import PlayApplication
from play.utils import *
åœ¨è„šæœ¬çš„å¼€å¤´ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œæ„å‘³ç€åªè¦åœ¨playä¸»ç¨‹åºæ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºidçš„æ–‡ä»¶ï¼Œå³å¯è®¾ç½®é»˜è®¤çš„æ¡†æ¶id
play_env["id_file"] = os.path.join(play_env[&#39;basedir&#39;], &#39;id&#39;)
if os.path.exists(play_env["id_file"]):
    play_env["id"] = open(play_env["id_file"]).readline().strip()
else:
    play_env["id"] = &#39;&#39;
å‘½ä»¤å‚æ•°çš„åˆ†éš”ç”±ä»¥ä¸‹ä»£ç å®Œæˆï¼Œä¾‹å¦‚ä½¿ç”¨äº†play run &ndash;%test,é‚£ä¹ˆå‚æ•°åˆ—è¡¨å°±æ˜¯

[&ldquo;xxxx\play&rdquo;,&ldquo;run&rdquo;,"&ndash;%test"]
è¿™æ®µä»£ç ä¹Ÿè¯´æ˜äº†ï¼Œplayçš„å‘½ä»¤æ ¼å¼ä¸º

play cmd [app_path] [&ndash;options]'><meta name=author content="luyanliang"><link rel=canonical href=https://example.org/posts/play-framework/part1-play-framework-%E4%BB%8B%E7%BB%8D%E9%A1%B9%E7%9B%AE%E6%9E%84%E6%88%90%E5%8F%8A%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E8%A7%A3%E6%9E%90/><meta name=google-site-verification content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://example.org/avatar.png><link rel=icon type=image/png sizes=16x16 href=https://example.org/avatar.png><link rel=icon type=image/png sizes=32x32 href=https://example.org/avatar.png><link rel=apple-touch-icon href=https://example.org/avatar.png><link rel=mask-icon href=https://example.org/avatar.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://example.org/posts/play-framework/part1-play-framework-%E4%BB%8B%E7%BB%8D%E9%A1%B9%E7%9B%AE%E6%9E%84%E6%88%90%E5%8F%8A%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E8%A7%A3%E6%9E%90/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://example.org/posts/play-framework/part1-play-framework-%E4%BB%8B%E7%BB%8D%E9%A1%B9%E7%9B%AE%E6%9E%84%E6%88%90%E5%8F%8A%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E8%A7%A3%E6%9E%90/"><meta property="og:site_name" content="404 NOT FOUND"><meta property="og:title" content="Play frameworkæºç è§£æ Part1: Play framework ä»‹ç»ã€é¡¹ç›®æ„æˆåŠå¯åŠ¨è„šæœ¬è§£æ"><meta property="og:description" content='æ³¨ï¼šæœ¬ç³»åˆ—æ–‡ç« æ‰€ç”¨playç‰ˆæœ¬ä¸º1.2.6
ä»‹ç» Play frameworkæ˜¯ä¸ªè½»é‡çº§çš„RESTfulæ¡†æ¶ï¼Œè‡´åŠ›äºè®©javaç¨‹åºå‘˜å®ç°å¿«é€Ÿé«˜æ•ˆå¼€å‘ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ä¼˜åŠ¿ï¼š
çƒ­åŠ è½½ã€‚åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä¿®æ”¹ä¼šåŠæ—¶ç”Ÿæ•ˆã€‚ æŠ›å¼ƒxmlé…ç½®æ–‡ä»¶ã€‚çº¦å®šå¤§äºé…ç½®ã€‚ æ”¯æŒå¼‚æ­¥ç¼–ç¨‹ æ— çŠ¶æ€mvcæ¡†æ¶ï¼Œæ‹“å±•æ€§è‰¯å¥½ ç®€å•çš„è·¯ç”±è®¾ç½® è¿™é‡Œé™„ä¸ŠPlay frameworkçš„æ–‡æ¡£åœ°å€ï¼Œå®˜æ–¹æœ‰æ›´ä¸ºè¯¦å°½çš„åŠŸèƒ½å™è¿°ã€‚Play frameworkæ–‡æ¡£
é¡¹ç›®æ„æˆ play frameworkçš„åˆå§‹åŒ–éå¸¸ç®€å•ï¼Œåªè¦ä¸‹è½½äº†playçš„è½¯ä»¶åŒ…åï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œplay new xxxå³å¯åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ã€‚ è‡ªåŠ¨ç”Ÿæˆçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š
è¿è¡Œplayç¨‹åºä¹Ÿéå¸¸ç®€å•ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹ä½¿ç”¨
play run å³å¯è¿è¡Œã€‚
å¯åŠ¨è„šæœ¬è§£æ play frameworkè½¯ä»¶åŒ…ç›®å½• ä¸ºäº†æ›´å¥½çš„äº†è§£play frameworkçš„è¿ä½œåŸç†ï¼Œæˆ‘ä»¬æ¥ä»play frameworkçš„å¯åŠ¨è„šæœ¬å¼€å§‹åˆ†æï¼Œåˆ†æå¯åŠ¨è„šæœ¬æœ‰åŠ©äºæˆ‘ä»¬äº†è§£play frameworkçš„è¿è¡Œè¿‡ç¨‹ã€‚
playçš„å¯åŠ¨è„šæœ¬æ˜¯ä½¿ç”¨pythonç¼–å†™çš„ï¼Œè„šæœ¬çš„å…¥å£ä¸ºplayè½¯ä»¶åŒ…æ ¹ç›®å½•ä¸‹çš„playæ–‡ä»¶,ä¸‹é¢æˆ‘ä»¬å°†ä»playè¿™ä¸ªè„šæœ¬çš„ä¸»å…¥å£å¼€å§‹åˆ†æã€‚
playè„šæœ¬è§£æ playè„šæœ¬åœ¨å¼€å¤´å¼•å…¥äº†3ä¸ªç±»ï¼Œåˆ†åˆ«ä¸ºplay.cmdloader,play.application,play.utilsï¼Œä»æ·»åŠ çš„ç³»ç»Ÿå‚æ•°ä¸­å¯ä»¥çœ‹å‡ºplayå¯åŠ¨è„šæœ¬çš„å­˜æ”¾è·¯å¾„ä¸º framework/pym cmdloader.pyçš„ä¸»è¦ä½œç”¨ä¸ºåŠ è½½framework/pym/commandsä¸‹çš„å„ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨äºä¹‹åå¯¹å‘½ä»¤å‚æ•°çš„è§£é‡Šè¿è¡Œ application.pyçš„ä¸»è¦ä½œç”¨ä¸ºè§£æé¡¹ç›®è·¯å¾„ä¸‹conf/ä¸­çš„é…ç½®æ–‡ä»¶ã€åŠ è½½æ¨¡å—ã€æ‹¼æ¥æœ€åè¿è¡Œçš„javaå‘½ä»¤
sys.path.append(os.path.join(os.path.dirname(os.path.realpath(sys.argv[0])), &#39;framework&#39;, &#39;pym&#39;)) from play.cmdloader import CommandLoader from play.application import PlayApplication from play.utils import * åœ¨è„šæœ¬çš„å¼€å¤´ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œæ„å‘³ç€åªè¦åœ¨playä¸»ç¨‹åºæ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºidçš„æ–‡ä»¶ï¼Œå³å¯è®¾ç½®é»˜è®¤çš„æ¡†æ¶id
play_env["id_file"] = os.path.join(play_env[&#39;basedir&#39;], &#39;id&#39;) if os.path.exists(play_env["id_file"]): play_env["id"] = open(play_env["id_file"]).readline().strip() else: play_env["id"] = &#39;&#39; å‘½ä»¤å‚æ•°çš„åˆ†éš”ç”±ä»¥ä¸‹ä»£ç å®Œæˆï¼Œä¾‹å¦‚ä½¿ç”¨äº†play run â€“%test,é‚£ä¹ˆå‚æ•°åˆ—è¡¨å°±æ˜¯
[â€œxxxx\playâ€,â€œrunâ€,"â€“%test"]
è¿™æ®µä»£ç ä¹Ÿè¯´æ˜äº†ï¼Œplayçš„å‘½ä»¤æ ¼å¼ä¸º
play cmd [app_path] [â€“options]'><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-01-03T13:56:21+00:00"><meta property="article:modified_time" content="2018-01-03T13:56:21+00:00"><meta property="article:tag" content="Program"><meta property="article:tag" content="Backend"><meta property="og:image" content="https://example.org/avatar.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://example.org/avatar.png"><meta name=twitter:title content="Play frameworkæºç è§£æ Part1: Play framework ä»‹ç»ã€é¡¹ç›®æ„æˆåŠå¯åŠ¨è„šæœ¬è§£æ"><meta name=twitter:description content='æ³¨ï¼šæœ¬ç³»åˆ—æ–‡ç« æ‰€ç”¨playç‰ˆæœ¬ä¸º1.2.6

ä»‹ç»
Play frameworkæ˜¯ä¸ªè½»é‡çº§çš„RESTfulæ¡†æ¶ï¼Œè‡´åŠ›äºè®©javaç¨‹åºå‘˜å®ç°å¿«é€Ÿé«˜æ•ˆå¼€å‘ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ä¼˜åŠ¿ï¼š

çƒ­åŠ è½½ã€‚åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä¿®æ”¹ä¼šåŠæ—¶ç”Ÿæ•ˆã€‚
æŠ›å¼ƒxmlé…ç½®æ–‡ä»¶ã€‚çº¦å®šå¤§äºé…ç½®ã€‚
æ”¯æŒå¼‚æ­¥ç¼–ç¨‹
æ— çŠ¶æ€mvcæ¡†æ¶ï¼Œæ‹“å±•æ€§è‰¯å¥½
ç®€å•çš„è·¯ç”±è®¾ç½®

è¿™é‡Œé™„ä¸ŠPlay frameworkçš„æ–‡æ¡£åœ°å€ï¼Œå®˜æ–¹æœ‰æ›´ä¸ºè¯¦å°½çš„åŠŸèƒ½å™è¿°ã€‚Play frameworkæ–‡æ¡£


é¡¹ç›®æ„æˆ
play frameworkçš„åˆå§‹åŒ–éå¸¸ç®€å•ï¼Œåªè¦ä¸‹è½½äº†playçš„è½¯ä»¶åŒ…åï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œplay new xxxå³å¯åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ã€‚
è‡ªåŠ¨ç”Ÿæˆçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š

è¿è¡Œplayç¨‹åºä¹Ÿéå¸¸ç®€å•ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹ä½¿ç”¨
play run
å³å¯è¿è¡Œã€‚

å¯åŠ¨è„šæœ¬è§£æ
play frameworkè½¯ä»¶åŒ…ç›®å½•
ä¸ºäº†æ›´å¥½çš„äº†è§£play frameworkçš„è¿ä½œåŸç†ï¼Œæˆ‘ä»¬æ¥ä»play frameworkçš„å¯åŠ¨è„šæœ¬å¼€å§‹åˆ†æï¼Œåˆ†æå¯åŠ¨è„šæœ¬æœ‰åŠ©äºæˆ‘ä»¬äº†è§£play frameworkçš„è¿è¡Œè¿‡ç¨‹ã€‚
playçš„å¯åŠ¨è„šæœ¬æ˜¯ä½¿ç”¨pythonç¼–å†™çš„ï¼Œè„šæœ¬çš„å…¥å£ä¸ºplayè½¯ä»¶åŒ…æ ¹ç›®å½•ä¸‹çš„playæ–‡ä»¶,ä¸‹é¢æˆ‘ä»¬å°†ä»playè¿™ä¸ªè„šæœ¬çš„ä¸»å…¥å£å¼€å§‹åˆ†æã€‚

playè„šæœ¬è§£æ
playè„šæœ¬åœ¨å¼€å¤´å¼•å…¥äº†3ä¸ªç±»ï¼Œåˆ†åˆ«ä¸ºplay.cmdloader,play.application,play.utilsï¼Œä»æ·»åŠ çš„ç³»ç»Ÿå‚æ•°ä¸­å¯ä»¥çœ‹å‡ºplayå¯åŠ¨è„šæœ¬çš„å­˜æ”¾è·¯å¾„ä¸º framework/pym
cmdloader.pyçš„ä¸»è¦ä½œç”¨ä¸ºåŠ è½½framework/pym/commandsä¸‹çš„å„ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨äºä¹‹åå¯¹å‘½ä»¤å‚æ•°çš„è§£é‡Šè¿è¡Œ
application.pyçš„ä¸»è¦ä½œç”¨ä¸ºè§£æé¡¹ç›®è·¯å¾„ä¸‹conf/ä¸­çš„é…ç½®æ–‡ä»¶ã€åŠ è½½æ¨¡å—ã€æ‹¼æ¥æœ€åè¿è¡Œçš„javaå‘½ä»¤
sys.path.append(os.path.join(os.path.dirname(os.path.realpath(sys.argv[0])), &#39;framework&#39;, &#39;pym&#39;))

from play.cmdloader import CommandLoader
from play.application import PlayApplication
from play.utils import *
åœ¨è„šæœ¬çš„å¼€å¤´ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œæ„å‘³ç€åªè¦åœ¨playä¸»ç¨‹åºæ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºidçš„æ–‡ä»¶ï¼Œå³å¯è®¾ç½®é»˜è®¤çš„æ¡†æ¶id
play_env["id_file"] = os.path.join(play_env[&#39;basedir&#39;], &#39;id&#39;)
if os.path.exists(play_env["id_file"]):
    play_env["id"] = open(play_env["id_file"]).readline().strip()
else:
    play_env["id"] = &#39;&#39;
å‘½ä»¤å‚æ•°çš„åˆ†éš”ç”±ä»¥ä¸‹ä»£ç å®Œæˆï¼Œä¾‹å¦‚ä½¿ç”¨äº†play run &ndash;%test,é‚£ä¹ˆå‚æ•°åˆ—è¡¨å°±æ˜¯

[&ldquo;xxxx\play&rdquo;,&ldquo;run&rdquo;,"&ndash;%test"]
è¿™æ®µä»£ç ä¹Ÿè¯´æ˜äº†ï¼Œplayçš„å‘½ä»¤æ ¼å¼ä¸º

play cmd [app_path] [&ndash;options]'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://example.org/posts/"},{"@type":"ListItem","position":2,"name":"Play frameworkæºç è§£æ Part1: Play framework ä»‹ç»ã€é¡¹ç›®æ„æˆåŠå¯åŠ¨è„šæœ¬è§£æ","item":"https://example.org/posts/play-framework/part1-play-framework-%E4%BB%8B%E7%BB%8D%E9%A1%B9%E7%9B%AE%E6%9E%84%E6%88%90%E5%8F%8A%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E8%A7%A3%E6%9E%90/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Play frameworkæºç è§£æ Part1: Play framework ä»‹ç»ã€é¡¹ç›®æ„æˆåŠå¯åŠ¨è„šæœ¬è§£æ","name":"Play frameworkæºç è§£æ Part1: Play framework ä»‹ç»ã€é¡¹ç›®æ„æˆåŠå¯åŠ¨è„šæœ¬è§£æ","description":"æ³¨ï¼šæœ¬ç³»åˆ—æ–‡ç« æ‰€ç”¨playç‰ˆæœ¬ä¸º1.2.6\nä»‹ç» Play frameworkæ˜¯ä¸ªè½»é‡çº§çš„RESTfulæ¡†æ¶ï¼Œè‡´åŠ›äºè®©javaç¨‹åºå‘˜å®ç°å¿«é€Ÿé«˜æ•ˆå¼€å‘ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ä¼˜åŠ¿ï¼š\nçƒ­åŠ è½½ã€‚åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä¿®æ”¹ä¼šåŠæ—¶ç”Ÿæ•ˆã€‚ æŠ›å¼ƒxmlé…ç½®æ–‡ä»¶ã€‚çº¦å®šå¤§äºé…ç½®ã€‚ æ”¯æŒå¼‚æ­¥ç¼–ç¨‹ æ— çŠ¶æ€mvcæ¡†æ¶ï¼Œæ‹“å±•æ€§è‰¯å¥½ ç®€å•çš„è·¯ç”±è®¾ç½® è¿™é‡Œé™„ä¸ŠPlay frameworkçš„æ–‡æ¡£åœ°å€ï¼Œå®˜æ–¹æœ‰æ›´ä¸ºè¯¦å°½çš„åŠŸèƒ½å™è¿°ã€‚Play frameworkæ–‡æ¡£\né¡¹ç›®æ„æˆ play frameworkçš„åˆå§‹åŒ–éå¸¸ç®€å•ï¼Œåªè¦ä¸‹è½½äº†playçš„è½¯ä»¶åŒ…åï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œplay new xxxå³å¯åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ã€‚ è‡ªåŠ¨ç”Ÿæˆçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\nè¿è¡Œplayç¨‹åºä¹Ÿéå¸¸ç®€å•ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹ä½¿ç”¨\nplay run å³å¯è¿è¡Œã€‚\nå¯åŠ¨è„šæœ¬è§£æ play frameworkè½¯ä»¶åŒ…ç›®å½• ä¸ºäº†æ›´å¥½çš„äº†è§£play frameworkçš„è¿ä½œåŸç†ï¼Œæˆ‘ä»¬æ¥ä»play frameworkçš„å¯åŠ¨è„šæœ¬å¼€å§‹åˆ†æï¼Œåˆ†æå¯åŠ¨è„šæœ¬æœ‰åŠ©äºæˆ‘ä»¬äº†è§£play frameworkçš„è¿è¡Œè¿‡ç¨‹ã€‚\nplayçš„å¯åŠ¨è„šæœ¬æ˜¯ä½¿ç”¨pythonç¼–å†™çš„ï¼Œè„šæœ¬çš„å…¥å£ä¸ºplayè½¯ä»¶åŒ…æ ¹ç›®å½•ä¸‹çš„playæ–‡ä»¶,ä¸‹é¢æˆ‘ä»¬å°†ä»playè¿™ä¸ªè„šæœ¬çš„ä¸»å…¥å£å¼€å§‹åˆ†æã€‚\nplayè„šæœ¬è§£æ playè„šæœ¬åœ¨å¼€å¤´å¼•å…¥äº†3ä¸ªç±»ï¼Œåˆ†åˆ«ä¸ºplay.cmdloader,play.application,play.utilsï¼Œä»æ·»åŠ çš„ç³»ç»Ÿå‚æ•°ä¸­å¯ä»¥çœ‹å‡ºplayå¯åŠ¨è„šæœ¬çš„å­˜æ”¾è·¯å¾„ä¸º framework/pym cmdloader.pyçš„ä¸»è¦ä½œç”¨ä¸ºåŠ è½½framework/pym/commandsä¸‹çš„å„ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨äºä¹‹åå¯¹å‘½ä»¤å‚æ•°çš„è§£é‡Šè¿è¡Œ application.pyçš„ä¸»è¦ä½œç”¨ä¸ºè§£æé¡¹ç›®è·¯å¾„ä¸‹conf/ä¸­çš„é…ç½®æ–‡ä»¶ã€åŠ è½½æ¨¡å—ã€æ‹¼æ¥æœ€åè¿è¡Œçš„javaå‘½ä»¤\nsys.path.append(os.path.join(os.path.dirname(os.path.realpath(sys.argv[0])), \u0026#39;framework\u0026#39;, \u0026#39;pym\u0026#39;)) from play.cmdloader import CommandLoader from play.application import PlayApplication from play.utils import * åœ¨è„šæœ¬çš„å¼€å¤´ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œæ„å‘³ç€åªè¦åœ¨playä¸»ç¨‹åºæ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºidçš„æ–‡ä»¶ï¼Œå³å¯è®¾ç½®é»˜è®¤çš„æ¡†æ¶id\nplay_env[\u0026#34;id_file\u0026#34;] = os.path.join(play_env[\u0026#39;basedir\u0026#39;], \u0026#39;id\u0026#39;) if os.path.exists(play_env[\u0026#34;id_file\u0026#34;]): play_env[\u0026#34;id\u0026#34;] = open(play_env[\u0026#34;id_file\u0026#34;]).readline().strip() else: play_env[\u0026#34;id\u0026#34;] = \u0026#39;\u0026#39; å‘½ä»¤å‚æ•°çš„åˆ†éš”ç”±ä»¥ä¸‹ä»£ç å®Œæˆï¼Œä¾‹å¦‚ä½¿ç”¨äº†play run \u0026ndash;%test,é‚£ä¹ˆå‚æ•°åˆ—è¡¨å°±æ˜¯\n[\u0026ldquo;xxxx\\play\u0026rdquo;,\u0026ldquo;run\u0026rdquo;,\u0026quot;\u0026ndash;%test\u0026quot;]\nè¿™æ®µä»£ç ä¹Ÿè¯´æ˜äº†ï¼Œplayçš„å‘½ä»¤æ ¼å¼ä¸º\nplay cmd [app_path] [\u0026ndash;options]\n","keywords":["program","backend"],"articleBody":"æ³¨ï¼šæœ¬ç³»åˆ—æ–‡ç« æ‰€ç”¨playç‰ˆæœ¬ä¸º1.2.6\nä»‹ç» Play frameworkæ˜¯ä¸ªè½»é‡çº§çš„RESTfulæ¡†æ¶ï¼Œè‡´åŠ›äºè®©javaç¨‹åºå‘˜å®ç°å¿«é€Ÿé«˜æ•ˆå¼€å‘ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ä¼˜åŠ¿ï¼š\nçƒ­åŠ è½½ã€‚åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä¿®æ”¹ä¼šåŠæ—¶ç”Ÿæ•ˆã€‚ æŠ›å¼ƒxmlé…ç½®æ–‡ä»¶ã€‚çº¦å®šå¤§äºé…ç½®ã€‚ æ”¯æŒå¼‚æ­¥ç¼–ç¨‹ æ— çŠ¶æ€mvcæ¡†æ¶ï¼Œæ‹“å±•æ€§è‰¯å¥½ ç®€å•çš„è·¯ç”±è®¾ç½® è¿™é‡Œé™„ä¸ŠPlay frameworkçš„æ–‡æ¡£åœ°å€ï¼Œå®˜æ–¹æœ‰æ›´ä¸ºè¯¦å°½çš„åŠŸèƒ½å™è¿°ã€‚Play frameworkæ–‡æ¡£\né¡¹ç›®æ„æˆ play frameworkçš„åˆå§‹åŒ–éå¸¸ç®€å•ï¼Œåªè¦ä¸‹è½½äº†playçš„è½¯ä»¶åŒ…åï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œplay new xxxå³å¯åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ã€‚ è‡ªåŠ¨ç”Ÿæˆçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\nè¿è¡Œplayç¨‹åºä¹Ÿéå¸¸ç®€å•ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹ä½¿ç”¨\nplay run å³å¯è¿è¡Œã€‚\nå¯åŠ¨è„šæœ¬è§£æ play frameworkè½¯ä»¶åŒ…ç›®å½• ä¸ºäº†æ›´å¥½çš„äº†è§£play frameworkçš„è¿ä½œåŸç†ï¼Œæˆ‘ä»¬æ¥ä»play frameworkçš„å¯åŠ¨è„šæœ¬å¼€å§‹åˆ†æï¼Œåˆ†æå¯åŠ¨è„šæœ¬æœ‰åŠ©äºæˆ‘ä»¬äº†è§£play frameworkçš„è¿è¡Œè¿‡ç¨‹ã€‚\nplayçš„å¯åŠ¨è„šæœ¬æ˜¯ä½¿ç”¨pythonç¼–å†™çš„ï¼Œè„šæœ¬çš„å…¥å£ä¸ºplayè½¯ä»¶åŒ…æ ¹ç›®å½•ä¸‹çš„playæ–‡ä»¶,ä¸‹é¢æˆ‘ä»¬å°†ä»playè¿™ä¸ªè„šæœ¬çš„ä¸»å…¥å£å¼€å§‹åˆ†æã€‚\nplayè„šæœ¬è§£æ playè„šæœ¬åœ¨å¼€å¤´å¼•å…¥äº†3ä¸ªç±»ï¼Œåˆ†åˆ«ä¸ºplay.cmdloader,play.application,play.utilsï¼Œä»æ·»åŠ çš„ç³»ç»Ÿå‚æ•°ä¸­å¯ä»¥çœ‹å‡ºplayå¯åŠ¨è„šæœ¬çš„å­˜æ”¾è·¯å¾„ä¸º framework/pym cmdloader.pyçš„ä¸»è¦ä½œç”¨ä¸ºåŠ è½½framework/pym/commandsä¸‹çš„å„ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨äºä¹‹åå¯¹å‘½ä»¤å‚æ•°çš„è§£é‡Šè¿è¡Œ application.pyçš„ä¸»è¦ä½œç”¨ä¸ºè§£æé¡¹ç›®è·¯å¾„ä¸‹conf/ä¸­çš„é…ç½®æ–‡ä»¶ã€åŠ è½½æ¨¡å—ã€æ‹¼æ¥æœ€åè¿è¡Œçš„javaå‘½ä»¤\nsys.path.append(os.path.join(os.path.dirname(os.path.realpath(sys.argv[0])), 'framework', 'pym')) from play.cmdloader import CommandLoader from play.application import PlayApplication from play.utils import * åœ¨è„šæœ¬çš„å¼€å¤´ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œæ„å‘³ç€åªè¦åœ¨playä¸»ç¨‹åºæ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºidçš„æ–‡ä»¶ï¼Œå³å¯è®¾ç½®é»˜è®¤çš„æ¡†æ¶id\nplay_env[\"id_file\"] = os.path.join(play_env['basedir'], 'id') if os.path.exists(play_env[\"id_file\"]): play_env[\"id\"] = open(play_env[\"id_file\"]).readline().strip() else: play_env[\"id\"] = '' å‘½ä»¤å‚æ•°çš„åˆ†éš”ç”±ä»¥ä¸‹ä»£ç å®Œæˆï¼Œä¾‹å¦‚ä½¿ç”¨äº†play run â€“%test,é‚£ä¹ˆå‚æ•°åˆ—è¡¨å°±æ˜¯\n[â€œxxxx\\playâ€,â€œrunâ€,\"â€“%test\"]\nè¿™æ®µä»£ç ä¹Ÿè¯´æ˜äº†ï¼Œplayçš„å‘½ä»¤æ ¼å¼ä¸º\nplay cmd [app_path] [â€“options]\napplication_path = None remaining_args = [] if len(sys.argv) == 1: application_path = os.getcwd() if len(sys.argv) == 2: application_path = os.getcwd() remaining_args = sys.argv[2:] if len(sys.argv) \u003e 2: if sys.argv[2].startswith('-'): application_path = os.getcwd() remaining_args = sys.argv[2:] else: application_path = os.path.normpath(os.path.abspath(sys.argv[2])) remaining_args = sys.argv[3:] åœ¨playå‚æ•°ä¸­ï¼Œæœ‰ä¸€ä¸ªignoreMissingï¼Œè¿™ä¸ªå‚æ•°çš„å…¨ç§°å…¶å®æ˜¯ignoreMissingModulesï¼Œä½œç”¨å°±æ˜¯åœ¨å½“é…ç½®æ–‡ä»¶ä¸­é…ç½®æœ‰æ¨¡å—ä½†æ˜¯åœ¨playç›®å½•ä¸‹å¹¶æ²¡æœ‰æ‰¾åˆ°æ—¶æ˜¯å¦å¿½ç•¥ï¼Œå¦‚éœ€å¿½ç•¥é‚£ä¹ˆåœ¨å¯åŠ¨æ—¶éœ€è¦åŠ å…¥--force\nignoreMissing = False if remaining_args.count('--force') == 1: remaining_args.remove('--force') ignoreMissing = True è„šæœ¬é€šè¿‡\nplay_app = PlayApplication(application_path, play_env, ignoreMissing)\nå’Œ\ncmdloader = CommandLoader(play_env[â€œbasedirâ€])\næ¥è¿›è¡ŒPlayApplicationç±»å’ŒCommandLoaderç±»çš„åˆå§‹åŒ–ã€‚ åœ¨PlayApplicationç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œå®ƒåˆ›å»ºäº†PlayConfParserç±»ç”¨æ¥è§£æé…ç½®æ–‡ä»¶ï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´playçš„é…ç½®æ–‡ä»¶è§£ææ˜¯åœ¨è„šæœ¬å¯åŠ¨é˜¶æ®µè¿›è¡Œçš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¿®æ”¹é…ç½®æ–‡ä»¶æ— æ³•å®æ—¶ç”Ÿæ•ˆéœ€è¦é‡å¯çš„åŸå› \nåœ¨PlayConfParserä¸­æœ‰ä¸€ä¸ªå¸¸é‡DEFAULTSå‚¨å­˜äº†é»˜è®¤çš„httpç«¯å£å’Œjpdaè°ƒè¯•ç«¯å£ï¼Œåˆ†åˆ«ä¸º9000å’Œ8000ï¼Œéœ€è¦æ·»åŠ é»˜è®¤å€¼å¯ä»¥ä¿®æ”¹DEFAULTSï¼ŒDEFAULTSå†…çš„å€¼åªæœ‰å½“é…ç½®æ–‡ä»¶ä¸­æ‰¾ä¸åˆ°æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚\nDEFAULTS = { 'http.port': '9000', 'jpda.port': '8000' } å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé…ç½®æ–‡ä»¶ä¸­çš„http.portçš„ä¼˜å…ˆçº§æ˜¯å°äºå‘½ä»¤å‚æ•°ä¸­çš„http.portçš„\n#envä¸ºå‘½ä»¤å‚æ•° if env.has_key('http.port'): self.entries['http.port'] = env['http.port'] CommandLoaderç±»çš„åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯éå†framework/pym/commandsä¸‹çš„.pyæ–‡ä»¶ï¼Œä¾æ¬¡åŠ è½½ç„¶åè¯»å–ä»–çš„å…¨å±€å˜é‡COMMANDSå’ŒMODULEå‚¨å­˜ç”¨äºä¹‹åçš„å‘½ä»¤å¤„ç†å’Œæ¨¡å—åŠ è½½ã€‚\nå›åˆ°playè„šæœ¬ä¸­ï¼Œåœ¨PlayApplicationç±»å’ŒCommandLoaderç±»åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œplayè¿›è¡Œ\"â€“deps\"å‚æ•°çš„æ£€æŸ¥ï¼Œå¦‚æœå­˜åœ¨â€“depsï¼Œåˆ™è°ƒç”¨play.deps.DependenciesManagerç±»æ¥è¿›è¡Œä¾èµ–çš„æ£€æŸ¥ã€æ›´æ–°ã€‚DependenciesManagerçš„è§£æå°†æ”¾åˆ°åè¯è¯¦è§£ã€‚\nif remaining_args.count('--deps') == 1: cmdloader.commands['dependencies'].execute(command='dependencies', app=play_app, args=['--sync'], env=play_env, cmdloader=cmdloader) remaining_args.remove('--deps') æ¥ä¸‹æ¥ï¼Œplayä¾¿æ­£å¼è¿›è¡Œå¯åŠ¨è¿‡ç¨‹ï¼ŒplayæŒ‰ç…§ä»¥ä¸‹çš„é¡ºåºè¿›è¡ŒåŠ è½½ï¼š\nåŠ è½½é…ç½®æ–‡ä»¶ä¸­è®°å½•çš„æ¨¡å—çš„å‘½ä»¤ä¿¡æ¯ åŠ è½½å‚æ•°ä¸­æŒ‡å®šçš„æ¨¡å—çš„å‘½ä»¤ä¿¡æ¯ è¿è¡Œå„æ¨¡å—ä¸­çš„beforeå‡½æ•° æ‰§è¡Œplay_command,play_commandå³ä¸ºrun,test,warç­‰playéœ€è¦çš„æ‰§è¡Œçš„å‘½ä»¤ è¿è¡Œå„æ¨¡å—ä¸­çš„afterå‡½æ•° ç»“æŸè„šæœ¬ if play_command in cmdloader.commands: for name in cmdloader.modules: module = cmdloader.modules[name] if 'before' in dir(module): module.before(command=play_command, app=play_app, args=remaining_args, env=play_env) status = cmdloader.commands[play_command].execute(command=play_command, app=play_app, args=remaining_args, env=play_env, cmdloader=cmdloader) for name in cmdloader.modules: module = cmdloader.modules[name] if 'after' in dir(module): module.after(command=play_command, app=play_app, args=remaining_args, env=play_env) sys.exit(status) ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹playå¸¸ç”¨å‘½ä»¤çš„è¿è¡Œè¿‡ç¨‹â€¦\nPlayå¸¸ç”¨è¿è¡Œå‘½ä»¤è§£æ åœ¨æœ¬èŠ‚çš„ä¸€å¼€å§‹ï¼Œæˆ‘å†³å®šå…ˆæŠŠplayæ‰€æœ‰çš„å¯ç”¨å‘½ä»¤å…ˆåˆ—ä¸¾ä¸€ä¸‹ï¼Œä»¥ä¾¿è¯»è€…å¯ä»¥é€‰æ‹©æ€§é˜…è¯»ã€‚\nå‘½ä»¤åç§° å‘½ä»¤æ‰€åœ¨æ–‡ä»¶ ä½œç”¨ antify ant.py åˆå§‹åŒ–antæ„å»ºå·¥å…·çš„build.xmlæ–‡ä»¶ run base.py è¿è¡Œç¨‹åº new base.py æ–°å»ºplayåº”ç”¨ clean base.py åˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œå³æ¸…ç©ºtmpæ–‡ä»¶å¤¹ test base.py è¿è¡Œæµ‹è¯•ç¨‹åº autotestã€auto-test base.py è‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•é¡¹ç›® id base.py è®¾ç½®é¡¹ç›®id new,run base.py æ–°å»ºplayåº”ç”¨å¹¶å¯åŠ¨ clean,run base.py åˆ é™¤ä¸´æ—¶æ–‡ä»¶å¹¶è¿è¡Œ modules base.py æ˜¾ç¤ºé¡¹ç›®ç”¨åˆ°çš„æ¨¡å—ï¼Œæ³¨ï¼šè¿™é‡Œæ˜¾ç¤ºçš„æ¨¡å—åªæ˜¯åœ¨é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨çš„æ¨¡å—ï¼Œå‘½ä»¤å‚æ•°ä¸­æ·»åŠ çš„æ¨¡å—ä¸ä¼šæ˜¾ç¤º check check.py æ£€æŸ¥playæ›´æ–° classpathã€cp classpath.py æ˜¾ç¤ºåº”ç”¨çš„classpath start daemon.py åœ¨åå°è¿è¡Œplayç¨‹åº stop daemon.py åœæ­¢æ­£åœ¨è¿è¡Œçš„ç¨‹åº restart daemon.py é‡å¯æ­£åœ¨è¿è¡Œçš„ç¨‹åº pid daemon.py æ˜¾ç¤ºè¿è¡Œä¸­çš„ç¨‹åºçš„pid out daemon.py æ˜¾ç¤ºè¾“å‡º dependenciesã€deps deps.py è¿è¡ŒDependenciesManageræ›´æ–°ä¾èµ– eclipsifyã€ec eclipse.py åˆ›å»ºeclipseé…ç½®æ–‡ä»¶ evolutions evolutions.py è¿è¡Œplay.db.Evolutionsè¿›è¡Œæ•°æ®åº“æ¼”å˜æ£€æŸ¥ help help.py è¾“å‡ºæ‰€æœ‰playçš„å¯ç”¨å‘½ä»¤ idealizeã€idea intellij.py ç”Ÿæˆideaé…ç½®æ–‡ä»¶ javadoc javadoc.py ç”Ÿæˆjavadoc new-moduleã€nm modulesrepo.py åˆ›å»ºæ–°æ¨¡å— list-modulesã€lm modulesrepo.py æ˜¾ç¤ºplayç¤¾åŒºä¸­çš„æ¨¡å— build-moduleã€bm modulesrepo.py æ‰“åŒ…æ¨¡å— add modulesrepo.py å°†æ¨¡å—æ·»åŠ è‡³é¡¹ç›® install modulesrepo.py å®‰è£…æ¨¡å— netbeansify netbeans.py ç”Ÿæˆnetbeansé…ç½®æ–‡ä»¶ precompile precompile.py é¢„ç¼–è¯‘ secret secret.py ç”Ÿæˆsecret key status status.py æ˜¾ç¤ºè¿è¡Œä¸­é¡¹ç›®çš„çŠ¶æ€ version version.py æ˜¾ç¤ºplay frameworkçš„ç‰ˆæœ¬å· war war.py å°†é¡¹ç›®æ‰“åŒ…ä¸ºwaræ–‡ä»¶ runä¸start runåº”è¯¥æ˜¯æˆ‘ä»¬å¹³æ—¶ç”¨çš„æœ€å¤šçš„å‘½ä»¤äº†ï¼Œrunå‘½ä»¤çš„ä½œç”¨å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯æ ¹æ®å‘½ä»¤å‚æ•°æ‹¼æ¥javaå‚æ•°ï¼Œç„¶åè°ƒç”¨javaæ¥è¿è¡Œplay.server.Serverï¼Œrunå‡½æ•°çš„ä»£ç å¦‚ä¸‹:\ndef run(app, args): #appå³ä¸ºplayè„šæœ¬ä¸­åˆ›å»ºçš„PlayApplicationç±» global process #è¿™é‡Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨conf/routeså’Œconf/application.conf app.check() print \"~ Ctrl+C to stop\" print \"~ \" java_cmd = app.java_cmd(args) try: process = subprocess.Popen (java_cmd, env=os.environ) signal.signal(signal.SIGTERM, handle_sigterm) return_code = process.wait() signal.signal(signal.SIGINT, handle_sigint) if 0 != return_code: sys.exit(return_code) except OSError: print \"Could not execute the java executable, please make sure the JAVA_HOME environment variable is set properly (the java executable should reside at JAVA_HOME/bin/java). \" sys.exit(-1) print app.java_cmd(args)çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š\ndef java_cmd(self, java_args, cp_args=None, className='play.server.Server', args = None): if args is None: args = [''] memory_in_args=False #æ£€æŸ¥javaå‚æ•°ä¸­æ˜¯å¦æœ‰jvmå†…å­˜è®¾ç½® for arg in java_args: if arg.startswith('-Xm'): memory_in_args=True #å¦‚æœå‚æ•°ä¸­æ— jvmå†…å­˜è®¾ç½®ï¼Œé‚£ä¹ˆåœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾æ˜¯å¦æœ‰jvmå†…å­˜è®¾ç½®ï¼Œè‹¥è¿˜æ˜¯æ²¡æœ‰åˆ™åœ¨ç¯å¢ƒå˜é‡ä¸­æ‰¾æ˜¯å¦æœ‰JAVA_OPTS #è¿™é‡Œå…¶å®æœ‰ä¸ªé—®é¢˜ï¼Œè¿™é‡Œå‡å®šçš„æ˜¯JAVA_OPTSå˜é‡é‡Œåªå­˜äº†jvmå†…å­˜è®¾ç½®ï¼Œå¦‚æœJAVA_OPTSè¿˜å­˜äº†å…¶ä»–é€‰é¡¹ï¼Œé‚£å¯¹è¿è¡Œå¯èƒ½æœ‰å½±å“ if not memory_in_args: memory = self.readConf('jvm.memory') if memory: java_args = java_args + memory.split(' ') elif 'JAVA_OPTS' in os.environ: java_args = java_args + os.environ['JAVA_OPTS'].split(' ') #è·å–ç¨‹åºçš„classpath if cp_args is None: cp_args = self.cp_args() #è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„jpdaç«¯å£ self.jpda_port = self.readConf('jpda.port') #è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„è¿è¡Œæ¨¡å¼ application_mode = self.readConf('application.mode').lower() #å¦‚æœæ¨¡å¼æ˜¯prodï¼Œåˆ™ç”¨serveræ¨¡å¼ç¼–è¯‘ if application_mode == 'prod': java_args.append('-server') # JDK 7 compat # ä½¿ç”¨æ–°classæ ¡éªŒå™¨ (ä¸çŸ¥é“ä½œç”¨) java_args.append('-XX:-UseSplitVerifier') #æŸ¥æ‰¾é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦æœ‰javaå®‰å…¨é…ç½®ï¼Œå¦‚æœæœ‰åˆ™åŠ å…¥javaå‚æ•°ä¸­ java_policy = self.readConf('java.policy') if java_policy != '': policyFile = os.path.join(self.path, 'conf', java_policy) if os.path.exists(policyFile): print \"~ using policy file \\\"%s\\\"\" % policyFile java_args.append('-Djava.security.manager') java_args.append('-Djava.security.policy==%s' % policyFile) #åŠ å…¥httpç«¯å£è®¾ç½® if self.play_env.has_key('http.port'): args += [\"--http.port=%s\" % self.play_env['http.port']] #åŠ å…¥httpsç«¯å£è®¾ç½® if self.play_env.has_key('https.port'): args += [\"--https.port=%s\" % self.play_env['https.port']] #è®¾ç½®æ–‡ä»¶ç¼–ç  java_args.append('-Dfile.encoding=utf-8') #è®¾ç½®ç¼–è¯‘å‘½ä»¤ (è¿™è¾¹ä½¿ç”¨äº†jregex/Pretokenizerç±»çš„nextæ–¹æ³•ï¼Œä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨) java_args.append('-XX:CompileCommand=exclude,jregex/Pretokenizer,next') #å¦‚æœç¨‹åºæ¨¡å¼åœ¨devï¼Œåˆ™æ·»åŠ jpdaè°ƒè¯•å™¨å‚æ•° if self.readConf('application.mode').lower() == 'dev': if not self.play_env[\"disable_check_jpda\"]: self.check_jpda() java_args.append('-Xdebug') java_args.append('-Xrunjdwp:transport=dt_socket,address=%s,server=y,suspend=n' % self.jpda_port) java_args.append('-Dplay.debug=yes') #æ‹¼æ¥javaå‚æ•° java_cmd = [self.java_path(), '-javaagent:%s' % self.agent_path()] + java_args + ['-classpath', cp_args, '-Dapplication.path=%s' % self.path, '-Dplay.id=%s' % self.play_env[\"id\"], className] + args return java_cmd startå‘½ä»¤ä¸runå‘½ä»¤å¾ˆç±»ä¼¼ï¼Œæ‰§è¡Œæ­¥éª¤ä¸ºï¼š\nä¾æ¬¡æŸ¥æ‰¾playå˜é‡pid_fileã€ç³»ç»Ÿç¯å¢ƒå˜é‡PLAY_PID_PATHã€é¡¹ç›®æ ¹ç›®å½•ä¸‹server.pidï¼ŒæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨æŒ‡å®špid è‹¥ç¬¬ä¸€æ­¥æ‰¾åˆ°pidï¼ŒæŸ¥æ‰¾å½“å‰è¿›ç¨‹åˆ—è¡¨ä¸­æ˜¯å¦å­˜åœ¨æ­¤pidè¿›ç¨‹ï¼Œå­˜åœ¨åˆ™è¯•å›¾å…³é—­è¿›ç¨‹ã€‚(å¦‚æœæ­¤æ—¶pidå·²ç»ä¸æ˜¯playçš„è¿›ç¨‹å‘¢ğŸ˜…) åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾application.log.system.outçœ‹æ˜¯å¦å…³é—­äº†ç³»ç»Ÿè¾“å‡º å¯åŠ¨ç¨‹åºï¼Œè¿™é‡Œä¸runå‘½ä»¤å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä»–æŒ‡å®šäº†stdoutä½ç½®ï¼Œè¿™æ ·å°±å˜æˆäº†åå°ç¨‹åº å°†å¯åŠ¨åçš„ç¨‹åºçš„pidå†™å…¥server.pid stopå‘½ä»¤å³å…³é—­å½“å‰è¿›ç¨‹ï¼Œè¿™é‡Œè¦æä¸€ä¸‹ï¼Œplayæœ‰ä¸ªæ³¨è§£å«OnApplicationStopï¼Œå³ä¼šåœ¨ç¨‹åºåœæ­¢æ—¶è§¦å‘ï¼Œè€ŒOnApplicationStopçš„å®ç°ä¸»è¦æ˜¯è°ƒç”¨äº†\nRuntime.getRuntime().addShutdownHook();\næ¥å®Œæˆ\ntestä¸autotest ä½¿ç”¨play testå‘½ä»¤å¯ä»¥è®©ç¨‹åºè¿›å…¥æµ‹è¯•æ¨¡å¼ï¼Œtestå‘½ä»¤å’Œrunå‘½ä»¤å…¶å®å·®åˆ«ä¸å¤§ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±åœ¨äºä½¿ç”¨testå‘½ä»¤æ—¶ï¼Œè„šæœ¬ä¼šå°†play idè‡ªåŠ¨æ›¿æ¢ä¸ºtestï¼Œå½“play idä¸ºtestæ—¶ä¼šè‡ªåŠ¨å¼•å…¥testrunneræ¨¡å—ï¼Œtestrunneræ¨¡å—ä¸»è¦åŠŸèƒ½ä¸ºæ·»åŠ @testsè·¯ç”±å¹¶å®ç°äº†testæµ‹è¯•é¡µé¢ï¼Œä»–çš„å…·ä½“å®ç°è¿‡ç¨‹åç»­å†è°ˆã€‚ autotestå‘½ä»¤çš„ä½œç”¨æ˜¯è‡ªåŠ¨æµ‹è¯•æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ï¼Œä»–çš„æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š\næ£€æŸ¥æ˜¯å¦å­˜åœ¨tmpæ–‡ä»¶å¤¹ï¼Œå­˜åœ¨å³åˆ é™¤ æ£€æŸ¥æ˜¯å¦æœ‰ç¨‹åºæ­£åœ¨è¿è¡Œï¼Œå¦‚å­˜åœ¨åˆ™å…³é—­ç¨‹åº æ£€æŸ¥ç¨‹åºæ˜¯å¦é…ç½®äº†sslä½†æ˜¯æ²¡æœ‰æŒ‡å®šè¯ä¹¦ æ£€æŸ¥æ˜¯å¦å­˜åœ¨test-resultæ–‡ä»¶å¤¹ï¼Œå­˜åœ¨å³åˆ é™¤ ä½¿ç”¨testä½œä¸ºidé‡å¯ç¨‹åº è°ƒç”¨play.modules.testrunner.FirePhoqueæ¥è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯• å…³é—­ç¨‹åº autotestçš„è„šæœ¬çš„æ­¥éª¤1å’Œ2æˆ‘è§‰å¾—æ˜¯æœ‰é—®é¢˜çš„ï¼Œåº”è¯¥æ¢ä¸‹é¡ºåºï¼Œä¸ç„¶å¦‚æœç¨‹åºæ­£åœ¨å‘tmpæ–‡ä»¶å¤¹æ’å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œé‚£ä¹ˆtmpæ–‡ä»¶å¤¹å°±åˆ é™¤å¤±è´¥äº†ã€‚ å…³é—­ç¨‹åºçš„ä»£ç è°ƒç”¨äº†http://localhost:%http_port/@killè¿›è¡Œå…³é—­ï¼Œ@killçš„å®ç°æ–¹æ³•åœ¨play.CorePluginä¸‹ï¼Œæ³¨æ„ï¼Œ@killåœ¨prodæ¨¡å¼ä¸‹æ— æ•ˆ (è¿™æ˜¯åºŸè¯)\nç”±äºä½¿ç”¨äº†pythonä½œä¸ºå¯åŠ¨è„šæœ¬ï¼Œæ— æ³•é€šè¿‡javaå†…éƒ¨å˜é‡å€¼åˆ¤æ–­ç¨‹åºæ˜¯å¦å¼€å¯ï¼Œåªèƒ½æŸ¥çœ‹æ§åˆ¶å°çš„è¾“å‡ºæ—¥å¿—ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨testä½œä¸ºidé‡å¯åï¼Œè„šæœ¬ä½¿ç”¨ä¸‹é¢çš„ä»£ç åˆ¤æ–­ç¨‹åºæ˜¯å¦å®Œå…¨å¯åŠ¨ï¼š\ntry: #è¿™é‡Œå¯åŠ¨ç¨‹åº play_process = subprocess.Popen(java_cmd, env=os.environ, stdout=sout) except OSError: print \"Could not execute the java executable, please make sure the JAVA_HOME environment variable is set properly (the java executable should reside at JAVA_HOME/bin/java). \" sys.exit(-1) #æ‰“å¼€æ—¥å¿—è¾“å‡ºæ–‡ä»¶ soutint = open(os.path.join(app.log_path(), 'system.out'), 'r') while True: if play_process.poll(): print \"~\" print \"~ Oops, application has not started?\" print \"~\" sys.exit(-1) line = soutint.readline().strip() if line: print line #è‹¥å‡ºç°'Server is up and running'åˆ™æ­£å¸¸å¯åŠ¨ if line.find('Server is up and running') \u003e -1: # This line is written out by Server.java to system.out and is not log file dependent soutint.close() break FirePhoqueç±»çš„å®ç°è¿‡ç¨‹æˆ‘ä»¬ä¹‹åå†è¯¦è§£ã€‚\nnewä¸clean æˆ‘ä»¬ä½¿ç”¨newæ¥åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œplay newçš„ä½¿ç”¨æ–¹æ³•ä¸ºplay new project-name [--with] [--name]ã€‚ withå‚æ•°ä¸ºé¡¹ç›®æ‰€ä½¿ç”¨çš„æ¨¡å—ã€‚ nameä¸ºé¡¹ç›®åï¼Œè¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ï¼Œproject-nameå’Œâ€“nameçš„å‚æ•°å¯ä»¥è®¾ç½®ä¸ºä¸åŒå€¼ï¼Œproject-nameæ˜¯é¡¹ç›®å»ºç«‹çš„æ–‡ä»¶å¤¹åï¼Œâ€“nameçš„å€¼ä¸ºé¡¹ç›®é…ç½®æ–‡ä»¶ä¸­çš„application.nameã€‚\nå¦‚æœä¸åŠ â€“nameï¼Œè„šæœ¬ä¼šæç¤ºä½ æ˜¯å¦ä½¿ç”¨project-nameä½œä¸ºåå­—ï¼Œåœ¨ç¡®è®¤ä¹‹åï¼Œè„šæœ¬ä¼šå°†resources/application-skelä¸­çš„æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ°{project-name}æ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åç”¨è¾“å…¥çš„nameæ›¿æ¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸‹çš„application.nameï¼Œå¹¶ç”Ÿæˆä¸€ä¸ª64ä½çš„secretKeyæ›¿æ¢é…ç½®æ–‡ä»¶ä¸­çš„secretKeyã€‚\næ¥ç€ï¼Œè„šæœ¬ä¼šæŸ¥æ‰¾ä½¿ç”¨çš„æ¨¡å—ä¸­æ˜¯å¦å­˜åœ¨dependencies.ymlï¼Œå¹¶å°†dependencies.ymlä¸­çš„å†…å®¹åŠ å…¥é¡¹ç›®çš„dependencies.ymlä¸­ï¼Œå¹¶è°ƒç”¨DependenciesManageræ£€æŸ¥ä¾èµ–çŠ¶æ€ã€‚\nnewå‡½æ•°çš„ä¸»è¦ä»£ç å¦‚ä¸‹:\nprint \"~ The new application will be created in %s\" % os.path.normpath(app.path) if application_name is None: application_name = raw_input(\"~ What is the application name? [%s] \" % os.path.basename(app.path)) if application_name == \"\": application_name = os.path.basename(app.path) copy_directory(os.path.join(env[\"basedir\"], 'resources/application-skel'), app.path) os.mkdir(os.path.join(app.path, 'app/models')) os.mkdir(os.path.join(app.path, 'lib')) app.check() replaceAll(os.path.join(app.path, 'conf/application.conf'), r'%APPLICATION_NAME%', application_name) replaceAll(os.path.join(app.path, 'conf/application.conf'), r'%SECRET_KEY%', secretKey()) print \"~\" cleanå‘½ä»¤éå¸¸ç®€å•ï¼Œå°±æ˜¯åˆ é™¤æ•´ä¸ªtmpæ–‡ä»¶å¤¹\nwarä¸precompile å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨tomcatç­‰æœåŠ¡å™¨å®¹å™¨ä½œä¸ºæœåŠ¡è½½ä½“ï¼Œè¿™æ—¶å€™å°±éœ€è¦å°†playåº”ç”¨æ‰“åŒ…ä¸ºwar\nwarçš„ä½¿ç”¨å‚æ•°æ˜¯\nplay war project-name [-o/â€“output][filename] [â€“zip] [â€“exclude][exclude-directories]\nä½¿ç”¨-oæˆ–â€“outputæ¥æŒ‡å®šè¾“å‡ºæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨â€“zipå‹ç¼©ä¸ºwaræ ¼å¼ï¼Œä½¿ç”¨â€“excludeæ¥åŒ…å«å¦å¤–éœ€è¦æ‰“åŒ…çš„æ–‡ä»¶å¤¹\nè¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»åœ¨é¡¹ç›®ç›®å½•å¤–è¿›è¡Œæ“ä½œï¼Œä¸ç„¶ä¼šå¤±è´¥\nåœ¨å‚æ•°å¤„ç†å®Œæ¯•åï¼Œè„šæœ¬æ­£å¼å¼€å§‹æ‰“åŒ…è¿‡ç¨‹ï¼Œåˆ†ä¸º2ä¸ªæ­¥éª¤ï¼š1.é¢„ç¼–è¯‘ã€‚2ï¼šæ‰“åŒ…\né¢„ç¼–è¯‘å³ç”¨åˆ°äº†precompileå‘½ä»¤ï¼Œprecompileå‘½ä»¤ä¸runå‘½ä»¤å‡ ä¹ä¸€æ ·ï¼Œåªæ˜¯åœ¨javaå‚æ•°ä¸­åŠ å…¥äº†precompile=yes\nè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åŠ å…¥äº†è¿™ä¸ªjavaå‚æ•°å¯¹ç¨‹åºçš„å½±å“ã€‚ ä¸é¢„ç¼–è¯‘æœ‰å…³çš„ä»£ç ä¸»è¦æ˜¯ä¸‹é¢2æ®µï¼š\nstatic boolean preCompile() { if (usePrecompiled) { if (Play.getFile(\"precompiled\").exists()) { classloader.getAllClasses(); Logger.info(\"Application is precompiled\"); return true; } Logger.error(\"Precompiled classes are missing!!\"); fatalServerErrorOccurred(); return false; } //è¿™é‡Œå¼€å§‹é¢„ç¼–è¯‘ try { Logger.info(\"Precompiling ...\"); Thread.currentThread().setContextClassLoader(Play.classloader); long start = System.currentTimeMillis(); //getAllClassesæ–¹æ³•è¾ƒé•¿ï¼Œå°±ä¸è´´äº†ï¼Œä¸‹é¢ä¸€æ®µä»£ç åœ¨getAllClassesæ–¹æ³•ä¸­è¿›å…¥ classloader.getAllClasses(); if (Logger.isTraceEnabled()) { Logger.trace(\"%sms to precompile the Java stuff\", System.currentTimeMillis() - start); } if (!lazyLoadTemplates) { start = System.currentTimeMillis(); //ç¼–è¯‘æ¨¡æ¿ TemplateLoader.getAllTemplate(); if (Logger.isTraceEnabled()) { Logger.trace(\"%sms to precompile the templates\", System.currentTimeMillis() - start); } } return true; } catch (Throwable e) { Logger.error(e, \"Cannot start in PROD mode with errors\"); fatalServerErrorOccurred(); return false; } } public byte[] enhance() { this.enhancedByteCode = this.javaByteCode; if (isClass()) { // before we can start enhancing this class we must make sure it is not a PlayPlugin. // PlayPlugins can be included as regular java files in a Play-application. // If a PlayPlugin is present in the application, it is loaded when other plugins are loaded. // All plugins must be loaded before we can start enhancing. // This is a problem when loading PlayPlugins bundled as regular app-class since it uses the same classloader // as the other (soon to be) enhanched play-app-classes. boolean shouldEnhance = true; try { CtClass ctClass = enhanceChecker_classPool.makeClass(new ByteArrayInputStream(this.enhancedByteCode)); if (ctClass.subclassOf(ctPlayPluginClass)) { shouldEnhance = false; } } catch( Exception e) { // nop } if (shouldEnhance) { Play.pluginCollection.enhance(this); } } //ä¸»è¦æ˜¯è¿™ä¸€æ®µï¼Œä»–å°†å¢å¼ºå¤„ç†åçš„å­—èŠ‚ç å†™å…¥äº†æ–‡ä»¶ï¼Œå¢å¼ºå¤„ç†åœ¨ä¹‹åä¼šæ·±å…¥å±•å¼€ if (System.getProperty(\"precompile\") != null) { try { // emit bytecode to standard class layout as well File f = Play.getFile(\"precompiled/java/\" + (name.replace(\".\", \"/\")) + \".class\"); f.getParentFile().mkdirs(); FileOutputStream fos = new FileOutputStream(f); fos.write(this.enhancedByteCode); fos.close(); } catch (Exception e) { e.printStackTrace(); } } return this.enhancedByteCode; } é¢„ç¼–è¯‘è¿‡ç¨‹ç»“æŸåï¼Œè„šæœ¬æ­£å¼å¼€å§‹æ‰“åŒ…è¿‡ç¨‹ï¼Œæ‰“åŒ…è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯è®²é¢„ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ã€æ¨¡æ¿æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€ä½¿ç”¨çš„ç±»åº“ã€ä½¿ç”¨çš„æ¨¡å—ç±»åº“ç­‰ç§»åŠ¨è‡³WEB-INFæ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœä½¿ç”¨äº†â€“zipï¼Œé‚£ä¹ˆè„šæœ¬ä¼šå°†ç”Ÿæˆçš„æ–‡ä»¶å¤¹ç”¨zipæ ¼å¼æ‰“åŒ…ã€‚\nsecretå’Œstatus secretå‘½ä»¤èƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„secret key statuså‘½ä»¤æ˜¯ç”¨äºå®æ—¶æ˜¾ç¤ºç¨‹åºçš„è¿è¡ŒçŠ¶æ€ï¼Œè„šæœ¬çš„è¿ä½œååˆ†ç®€å•ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š\næ£€æŸ¥æ˜¯å¦æœ‰â€“urlå‚æ•°ï¼Œæœ‰åˆ™åœ¨ä»–ä¹‹åæ·»åŠ @status æ£€æŸ¥æ˜¯å¦å­˜åœ¨â€“secret å¦‚æœæ²¡æœ‰â€“urlï¼Œåˆ™ä½¿ç”¨http://localhost:%http_port/@status;å¦‚æœæ²¡æœ‰ â€“secretï¼Œåˆ™ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–secret key å°†secret_keyã€â€™@statusâ€™ä½¿ç”¨shaåŠ å¯†ï¼Œå¹¶åŠ å…¥Authorizationè¯·æ±‚å¤´ å‘é€è¯·æ±‚ @statusçš„å®ç°å’Œ@killä¸€æ ·åœ¨CorePluginç±»ä¸­ï¼Œè¿™åœ¨ä¹‹åå†è¿›è¡Œè¯¦è§£ã€‚\næ€»ç»“ Playçš„å¯åŠ¨è„šæœ¬åˆ†æè‡³æ­¤å°±ç»“æŸäº†ï¼Œä»è„šæœ¬çš„åˆ†æè¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥ç¨å¾®æ¢ç©¶ä¸‹Playåœ¨è„šæœ¬å¯åŠ¨é˜¶æ®µæœ‰ä½•è¡Œä¸ºï¼Œè¿™å¯¹æˆ‘ä»¬è¿›è¡Œè„šæœ¬æ”¹é€ æˆ–è€…å¯åŠ¨ä¼˜åŒ–è¿˜æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚ ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹Playçš„å¯åŠ¨ç±»æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚ã€‚\n","wordCount":"1041","inLanguage":"en","image":"https://example.org/avatar.png","datePublished":"2018-01-03T13:56:21Z","dateModified":"2018-01-03T13:56:21Z","author":{"@type":"Person","name":"luyanliang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://example.org/posts/play-framework/part1-play-framework-%E4%BB%8B%E7%BB%8D%E9%A1%B9%E7%9B%AE%E6%9E%84%E6%88%90%E5%8F%8A%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E8%A7%A3%E6%9E%90/"},"publisher":{"@type":"Organization","name":"404 NOT FOUND","logo":{"@type":"ImageObject","url":"https://example.org/avatar.png"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://example.org/ accesskey=h title="404 NOT FOUND (Alt + H)">404 NOT FOUND</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://example.org/posts/ title=Blog><span>Blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://example.org/>Home</a>&nbsp;Â»&nbsp;<a href=https://example.org/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Play frameworkæºç è§£æ Part1: Play framework ä»‹ç»ã€é¡¹ç›®æ„æˆåŠå¯åŠ¨è„šæœ¬è§£æ</h1><div class=post-meta><span title='2018-01-03 13:56:21 +0000 UTC'>January 3, 2018</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;1041 words&nbsp;Â·&nbsp;luyanliang</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#play-frameworkè½¯ä»¶åŒ…ç›®å½•>play frameworkè½¯ä»¶åŒ…ç›®å½•</a></li><li><a href=#playè„šæœ¬è§£æ>playè„šæœ¬è§£æ</a></li><li><a href=#playå¸¸ç”¨è¿è¡Œå‘½ä»¤è§£æ>Playå¸¸ç”¨è¿è¡Œå‘½ä»¤è§£æ</a><ul><li><a href=#runä¸start>runä¸start</a></li><li><a href=#testä¸autotest>testä¸autotest</a></li><li><a href=#newä¸clean>newä¸clean</a></li><li><a href=#warä¸precompile>warä¸precompile</a></li><li><a href=#secretå’Œstatus>secretå’Œstatus</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><font color=#DC143C>æ³¨ï¼šæœ¬ç³»åˆ—æ–‡ç« æ‰€ç”¨playç‰ˆæœ¬ä¸º1.2.6</font></p><hr><h1 id=ä»‹ç»>ä»‹ç»<a hidden class=anchor aria-hidden=true href=#ä»‹ç»>#</a></h1><p>Play frameworkæ˜¯ä¸ªè½»é‡çº§çš„RESTfulæ¡†æ¶ï¼Œè‡´åŠ›äºè®©javaç¨‹åºå‘˜å®ç°å¿«é€Ÿé«˜æ•ˆå¼€å‘ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ä¼˜åŠ¿ï¼š</p><ol><li>çƒ­åŠ è½½ã€‚åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä¿®æ”¹ä¼šåŠæ—¶ç”Ÿæ•ˆã€‚</li><li>æŠ›å¼ƒxmlé…ç½®æ–‡ä»¶ã€‚çº¦å®šå¤§äºé…ç½®ã€‚</li><li>æ”¯æŒå¼‚æ­¥ç¼–ç¨‹</li><li>æ— çŠ¶æ€mvcæ¡†æ¶ï¼Œæ‹“å±•æ€§è‰¯å¥½</li><li>ç®€å•çš„è·¯ç”±è®¾ç½®</li></ol><p>è¿™é‡Œé™„ä¸ŠPlay frameworkçš„æ–‡æ¡£åœ°å€ï¼Œå®˜æ–¹æœ‰æ›´ä¸ºè¯¦å°½çš„åŠŸèƒ½å™è¿°ã€‚<a href=https://www.playframework.com/documentation/1.2.x/overview title=æ–‡æ¡£>Play frameworkæ–‡æ¡£</a></p><hr><h1 id=é¡¹ç›®æ„æˆ>é¡¹ç›®æ„æˆ<a hidden class=anchor aria-hidden=true href=#é¡¹ç›®æ„æˆ>#</a></h1><p>play frameworkçš„åˆå§‹åŒ–éå¸¸ç®€å•ï¼Œåªè¦ä¸‹è½½äº†playçš„è½¯ä»¶åŒ…åï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œplay new xxxå³å¯åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ã€‚
è‡ªåŠ¨ç”Ÿæˆçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p><p><img alt=playé¡¹ç›®ç»“æ„ loading=lazy src=https://i.loli.net/2018/01/08/5a53879bec91f.png></p><p>è¿è¡Œplayç¨‹åºä¹Ÿéå¸¸ç®€å•ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹ä½¿ç”¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>play run
</span></span></code></pre></div><p>å³å¯è¿è¡Œã€‚</p><hr><h1 id=å¯åŠ¨è„šæœ¬è§£æ>å¯åŠ¨è„šæœ¬è§£æ<a hidden class=anchor aria-hidden=true href=#å¯åŠ¨è„šæœ¬è§£æ>#</a></h1><h2 id=play-frameworkè½¯ä»¶åŒ…ç›®å½•>play frameworkè½¯ä»¶åŒ…ç›®å½•<a hidden class=anchor aria-hidden=true href=#play-frameworkè½¯ä»¶åŒ…ç›®å½•>#</a></h2><p>ä¸ºäº†æ›´å¥½çš„äº†è§£play frameworkçš„è¿ä½œåŸç†ï¼Œæˆ‘ä»¬æ¥ä»play frameworkçš„å¯åŠ¨è„šæœ¬å¼€å§‹åˆ†æï¼Œåˆ†æå¯åŠ¨è„šæœ¬æœ‰åŠ©äºæˆ‘ä»¬äº†è§£play frameworkçš„è¿è¡Œè¿‡ç¨‹ã€‚</p><p>playçš„å¯åŠ¨è„šæœ¬æ˜¯ä½¿ç”¨pythonç¼–å†™çš„ï¼Œè„šæœ¬çš„å…¥å£ä¸ºplayè½¯ä»¶åŒ…æ ¹ç›®å½•ä¸‹çš„playæ–‡ä»¶,ä¸‹é¢æˆ‘ä»¬å°†ä»playè¿™ä¸ªè„šæœ¬çš„ä¸»å…¥å£å¼€å§‹åˆ†æã€‚</p><p><img alt=playé¡¹ç›®ç»“æ„ loading=lazy src=https://i.loli.net/2018/01/08/5a5386dfdfdb6.png></p><h2 id=playè„šæœ¬è§£æ>playè„šæœ¬è§£æ<a hidden class=anchor aria-hidden=true href=#playè„šæœ¬è§£æ>#</a></h2><p>playè„šæœ¬åœ¨å¼€å¤´å¼•å…¥äº†3ä¸ªç±»ï¼Œåˆ†åˆ«ä¸ºplay.cmdloader,play.application,play.utilsï¼Œä»æ·»åŠ çš„ç³»ç»Ÿå‚æ•°ä¸­å¯ä»¥çœ‹å‡ºplayå¯åŠ¨è„šæœ¬çš„å­˜æ”¾è·¯å¾„ä¸º framework/pym
cmdloader.pyçš„ä¸»è¦ä½œç”¨ä¸ºåŠ è½½framework/pym/commandsä¸‹çš„å„ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨äºä¹‹åå¯¹å‘½ä»¤å‚æ•°çš„è§£é‡Šè¿è¡Œ
application.pyçš„ä¸»è¦ä½œç”¨ä¸ºè§£æé¡¹ç›®è·¯å¾„ä¸‹conf/ä¸­çš„é…ç½®æ–‡ä»¶ã€åŠ è½½æ¨¡å—ã€æ‹¼æ¥æœ€åè¿è¡Œçš„javaå‘½ä»¤</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sys<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>append(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>realpath(sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>0</span>])), <span style=color:#e6db74>&#39;framework&#39;</span>, <span style=color:#e6db74>&#39;pym&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> play.cmdloader <span style=color:#f92672>import</span> CommandLoader
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> play.application <span style=color:#f92672>import</span> PlayApplication
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> play.utils <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span></code></pre></div><p>åœ¨è„šæœ¬çš„å¼€å¤´ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œæ„å‘³ç€åªè¦åœ¨playä¸»ç¨‹åºæ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºidçš„æ–‡ä»¶ï¼Œå³å¯è®¾ç½®é»˜è®¤çš„æ¡†æ¶id</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>play_env[<span style=color:#e6db74>&#34;id_file&#34;</span>] <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(play_env[<span style=color:#e6db74>&#39;basedir&#39;</span>], <span style=color:#e6db74>&#39;id&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(play_env[<span style=color:#e6db74>&#34;id_file&#34;</span>]):
</span></span><span style=display:flex><span>    play_env[<span style=color:#e6db74>&#34;id&#34;</span>] <span style=color:#f92672>=</span> open(play_env[<span style=color:#e6db74>&#34;id_file&#34;</span>])<span style=color:#f92672>.</span>readline()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    play_env[<span style=color:#e6db74>&#34;id&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span></code></pre></div><p>å‘½ä»¤å‚æ•°çš„åˆ†éš”ç”±ä»¥ä¸‹ä»£ç å®Œæˆï¼Œä¾‹å¦‚ä½¿ç”¨äº†play run &ndash;%test,é‚£ä¹ˆå‚æ•°åˆ—è¡¨å°±æ˜¯</p><blockquote><p>[&ldquo;xxxx\play&rdquo;,&ldquo;run&rdquo;,"&ndash;%test"]</p></blockquote><p>è¿™æ®µä»£ç ä¹Ÿè¯´æ˜äº†ï¼Œplayçš„å‘½ä»¤æ ¼å¼ä¸º</p><blockquote><p>play cmd [app_path] [&ndash;options]</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>application_path <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>remaining_args <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>    application_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getcwd()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>    application_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getcwd()
</span></span><span style=display:flex><span>    remaining_args <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>2</span>:]
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;-&#39;</span>):
</span></span><span style=display:flex><span>        application_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getcwd()
</span></span><span style=display:flex><span>        remaining_args <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>2</span>:]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        application_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>normpath(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>abspath(sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>2</span>]))
</span></span><span style=display:flex><span>        remaining_args <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>3</span>:]
</span></span></code></pre></div><p>åœ¨playå‚æ•°ä¸­ï¼Œæœ‰ä¸€ä¸ªignoreMissingï¼Œè¿™ä¸ªå‚æ•°çš„å…¨ç§°å…¶å®æ˜¯ignoreMissingModulesï¼Œä½œç”¨å°±æ˜¯åœ¨å½“é…ç½®æ–‡ä»¶ä¸­é…ç½®æœ‰æ¨¡å—ä½†æ˜¯åœ¨playç›®å½•ä¸‹å¹¶æ²¡æœ‰æ‰¾åˆ°æ—¶æ˜¯å¦å¿½ç•¥ï¼Œå¦‚éœ€å¿½ç•¥é‚£ä¹ˆåœ¨å¯åŠ¨æ—¶éœ€è¦åŠ å…¥<code>--force</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>ignoreMissing <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> remaining_args<span style=color:#f92672>.</span>count(<span style=color:#e6db74>&#39;--force&#39;</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>    remaining_args<span style=color:#f92672>.</span>remove(<span style=color:#e6db74>&#39;--force&#39;</span>)
</span></span><span style=display:flex><span>    ignoreMissing <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span></code></pre></div><p>è„šæœ¬é€šè¿‡</p><blockquote><p>play_app = PlayApplication(application_path, play_env, ignoreMissing)</p></blockquote><p>å’Œ</p><blockquote><p>cmdloader = CommandLoader(play_env[&ldquo;basedir&rdquo;])</p></blockquote><p>æ¥è¿›è¡ŒPlayApplicationç±»å’ŒCommandLoaderç±»çš„åˆå§‹åŒ–ã€‚
åœ¨PlayApplicationç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œå®ƒåˆ›å»ºäº†PlayConfParserç±»ç”¨æ¥è§£æé…ç½®æ–‡ä»¶ï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´playçš„é…ç½®æ–‡ä»¶è§£ææ˜¯åœ¨è„šæœ¬å¯åŠ¨é˜¶æ®µè¿›è¡Œçš„ï¼Œ<strong>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¿®æ”¹é…ç½®æ–‡ä»¶æ— æ³•å®æ—¶ç”Ÿæ•ˆéœ€è¦é‡å¯çš„åŸå› </strong><br>åœ¨PlayConfParserä¸­æœ‰ä¸€ä¸ªå¸¸é‡DEFAULTSå‚¨å­˜äº†é»˜è®¤çš„httpç«¯å£å’Œjpdaè°ƒè¯•ç«¯å£ï¼Œåˆ†åˆ«ä¸º9000å’Œ8000ï¼Œéœ€è¦æ·»åŠ é»˜è®¤å€¼å¯ä»¥ä¿®æ”¹DEFAULTSï¼ŒDEFAULTSå†…çš„å€¼åªæœ‰å½“é…ç½®æ–‡ä»¶ä¸­æ‰¾ä¸åˆ°æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>DEFAULTS <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;http.port&#39;</span>: <span style=color:#e6db74>&#39;9000&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;jpda.port&#39;</span>: <span style=color:#e6db74>&#39;8000&#39;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé…ç½®æ–‡ä»¶ä¸­çš„http.portçš„ä¼˜å…ˆçº§æ˜¯å°äºå‘½ä»¤å‚æ•°ä¸­çš„http.portçš„</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#envä¸ºå‘½ä»¤å‚æ•°</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> env<span style=color:#f92672>.</span>has_key(<span style=color:#e6db74>&#39;http.port&#39;</span>):
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>entries[<span style=color:#e6db74>&#39;http.port&#39;</span>] <span style=color:#f92672>=</span> env[<span style=color:#e6db74>&#39;http.port&#39;</span>]
</span></span></code></pre></div><p>CommandLoaderç±»çš„åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯éå†framework/pym/commandsä¸‹çš„.pyæ–‡ä»¶ï¼Œä¾æ¬¡åŠ è½½ç„¶åè¯»å–ä»–çš„å…¨å±€å˜é‡COMMANDSå’ŒMODULEå‚¨å­˜ç”¨äºä¹‹åçš„å‘½ä»¤å¤„ç†å’Œæ¨¡å—åŠ è½½ã€‚</p><p>å›åˆ°playè„šæœ¬ä¸­ï¼Œåœ¨PlayApplicationç±»å’ŒCommandLoaderç±»åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œplayè¿›è¡Œ"&ndash;deps"å‚æ•°çš„æ£€æŸ¥ï¼Œå¦‚æœå­˜åœ¨&ndash;depsï¼Œåˆ™è°ƒç”¨play.deps.DependenciesManagerç±»æ¥è¿›è¡Œä¾èµ–çš„æ£€æŸ¥ã€æ›´æ–°ã€‚DependenciesManagerçš„è§£æå°†æ”¾åˆ°åè¯è¯¦è§£ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>if</span> remaining_args<span style=color:#f92672>.</span>count(<span style=color:#e6db74>&#39;--deps&#39;</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>    cmdloader<span style=color:#f92672>.</span>commands[<span style=color:#e6db74>&#39;dependencies&#39;</span>]<span style=color:#f92672>.</span>execute(command<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;dependencies&#39;</span>, app<span style=color:#f92672>=</span>play_app, args<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;--sync&#39;</span>], env<span style=color:#f92672>=</span>play_env, cmdloader<span style=color:#f92672>=</span>cmdloader)
</span></span><span style=display:flex><span>    remaining_args<span style=color:#f92672>.</span>remove(<span style=color:#e6db74>&#39;--deps&#39;</span>)
</span></span></code></pre></div><p>æ¥ä¸‹æ¥ï¼Œplayä¾¿æ­£å¼è¿›è¡Œå¯åŠ¨è¿‡ç¨‹ï¼ŒplayæŒ‰ç…§ä»¥ä¸‹çš„é¡ºåºè¿›è¡ŒåŠ è½½ï¼š</p><ol><li>åŠ è½½é…ç½®æ–‡ä»¶ä¸­è®°å½•çš„æ¨¡å—çš„å‘½ä»¤ä¿¡æ¯</li><li>åŠ è½½å‚æ•°ä¸­æŒ‡å®šçš„æ¨¡å—çš„å‘½ä»¤ä¿¡æ¯</li><li>è¿è¡Œå„æ¨¡å—ä¸­çš„beforeå‡½æ•°</li><li>æ‰§è¡Œplay_command,play_commandå³ä¸ºrun,test,warç­‰playéœ€è¦çš„æ‰§è¡Œçš„å‘½ä»¤</li><li>è¿è¡Œå„æ¨¡å—ä¸­çš„afterå‡½æ•°</li><li>ç»“æŸè„šæœ¬</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>if</span> play_command <span style=color:#f92672>in</span> cmdloader<span style=color:#f92672>.</span>commands:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> cmdloader<span style=color:#f92672>.</span>modules:
</span></span><span style=display:flex><span>        module <span style=color:#f92672>=</span> cmdloader<span style=color:#f92672>.</span>modules[name]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;before&#39;</span> <span style=color:#f92672>in</span> dir(module):
</span></span><span style=display:flex><span>            module<span style=color:#f92672>.</span>before(command<span style=color:#f92672>=</span>play_command, app<span style=color:#f92672>=</span>play_app, args<span style=color:#f92672>=</span>remaining_args, env<span style=color:#f92672>=</span>play_env)
</span></span><span style=display:flex><span>    status <span style=color:#f92672>=</span> cmdloader<span style=color:#f92672>.</span>commands[play_command]<span style=color:#f92672>.</span>execute(command<span style=color:#f92672>=</span>play_command, app<span style=color:#f92672>=</span>play_app, args<span style=color:#f92672>=</span>remaining_args, env<span style=color:#f92672>=</span>play_env, cmdloader<span style=color:#f92672>=</span>cmdloader)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> cmdloader<span style=color:#f92672>.</span>modules:
</span></span><span style=display:flex><span>        module <span style=color:#f92672>=</span> cmdloader<span style=color:#f92672>.</span>modules[name]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;after&#39;</span> <span style=color:#f92672>in</span> dir(module):
</span></span><span style=display:flex><span>            module<span style=color:#f92672>.</span>after(command<span style=color:#f92672>=</span>play_command, app<span style=color:#f92672>=</span>play_app, args<span style=color:#f92672>=</span>remaining_args, env<span style=color:#f92672>=</span>play_env)
</span></span><span style=display:flex><span>    sys<span style=color:#f92672>.</span>exit(status)
</span></span></code></pre></div><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹playå¸¸ç”¨å‘½ä»¤çš„è¿è¡Œè¿‡ç¨‹&mldr;</p><h2 id=playå¸¸ç”¨è¿è¡Œå‘½ä»¤è§£æ>Playå¸¸ç”¨è¿è¡Œå‘½ä»¤è§£æ<a hidden class=anchor aria-hidden=true href=#playå¸¸ç”¨è¿è¡Œå‘½ä»¤è§£æ>#</a></h2><p>åœ¨æœ¬èŠ‚çš„ä¸€å¼€å§‹ï¼Œæˆ‘å†³å®šå…ˆæŠŠplayæ‰€æœ‰çš„å¯ç”¨å‘½ä»¤å…ˆåˆ—ä¸¾ä¸€ä¸‹ï¼Œä»¥ä¾¿è¯»è€…å¯ä»¥é€‰æ‹©æ€§é˜…è¯»ã€‚</p><table><thead><tr><th>å‘½ä»¤åç§°</th><th>å‘½ä»¤æ‰€åœ¨æ–‡ä»¶</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>antify</td><td>ant.py</td><td>åˆå§‹åŒ–antæ„å»ºå·¥å…·çš„build.xmlæ–‡ä»¶</td></tr><tr><td>run</td><td>base.py</td><td>è¿è¡Œç¨‹åº</td></tr><tr><td>new</td><td>base.py</td><td>æ–°å»ºplayåº”ç”¨</td></tr><tr><td>clean</td><td>base.py</td><td>åˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œå³æ¸…ç©ºtmpæ–‡ä»¶å¤¹</td></tr><tr><td>test</td><td>base.py</td><td>è¿è¡Œæµ‹è¯•ç¨‹åº</td></tr><tr><td>autotestã€auto-test</td><td>base.py</td><td>è‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•é¡¹ç›®</td></tr><tr><td>id</td><td>base.py</td><td>è®¾ç½®é¡¹ç›®id</td></tr><tr><td>new,run</td><td>base.py</td><td>æ–°å»ºplayåº”ç”¨å¹¶å¯åŠ¨</td></tr><tr><td>clean,run</td><td>base.py</td><td>åˆ é™¤ä¸´æ—¶æ–‡ä»¶å¹¶è¿è¡Œ</td></tr><tr><td>modules</td><td>base.py</td><td>æ˜¾ç¤ºé¡¹ç›®ç”¨åˆ°çš„æ¨¡å—ï¼Œæ³¨ï¼šè¿™é‡Œæ˜¾ç¤ºçš„æ¨¡å—åªæ˜¯åœ¨é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨çš„æ¨¡å—ï¼Œå‘½ä»¤å‚æ•°ä¸­æ·»åŠ çš„æ¨¡å—ä¸ä¼šæ˜¾ç¤º</td></tr><tr><td>check</td><td>check.py</td><td>æ£€æŸ¥playæ›´æ–°</td></tr><tr><td>classpathã€cp</td><td>classpath.py</td><td>æ˜¾ç¤ºåº”ç”¨çš„classpath</td></tr><tr><td>start</td><td>daemon.py</td><td>åœ¨åå°è¿è¡Œplayç¨‹åº</td></tr><tr><td>stop</td><td>daemon.py</td><td>åœæ­¢æ­£åœ¨è¿è¡Œçš„ç¨‹åº</td></tr><tr><td>restart</td><td>daemon.py</td><td>é‡å¯æ­£åœ¨è¿è¡Œçš„ç¨‹åº</td></tr><tr><td>pid</td><td>daemon.py</td><td>æ˜¾ç¤ºè¿è¡Œä¸­çš„ç¨‹åºçš„pid</td></tr><tr><td>out</td><td>daemon.py</td><td>æ˜¾ç¤ºè¾“å‡º</td></tr><tr><td>dependenciesã€deps</td><td>deps.py</td><td>è¿è¡ŒDependenciesManageræ›´æ–°ä¾èµ–</td></tr><tr><td>eclipsifyã€ec</td><td>eclipse.py</td><td>åˆ›å»ºeclipseé…ç½®æ–‡ä»¶</td></tr><tr><td>evolutions</td><td>evolutions.py</td><td>è¿è¡Œplay.db.Evolutionsè¿›è¡Œæ•°æ®åº“æ¼”å˜æ£€æŸ¥</td></tr><tr><td>help</td><td>help.py</td><td>è¾“å‡ºæ‰€æœ‰playçš„å¯ç”¨å‘½ä»¤</td></tr><tr><td>idealizeã€idea</td><td>intellij.py</td><td>ç”Ÿæˆideaé…ç½®æ–‡ä»¶</td></tr><tr><td>javadoc</td><td>javadoc.py</td><td>ç”Ÿæˆjavadoc</td></tr><tr><td>new-moduleã€nm</td><td>modulesrepo.py</td><td>åˆ›å»ºæ–°æ¨¡å—</td></tr><tr><td>list-modulesã€lm</td><td>modulesrepo.py</td><td>æ˜¾ç¤ºplayç¤¾åŒºä¸­çš„æ¨¡å—</td></tr><tr><td>build-moduleã€bm</td><td>modulesrepo.py</td><td>æ‰“åŒ…æ¨¡å—</td></tr><tr><td>add</td><td>modulesrepo.py</td><td>å°†æ¨¡å—æ·»åŠ è‡³é¡¹ç›®</td></tr><tr><td>install</td><td>modulesrepo.py</td><td>å®‰è£…æ¨¡å—</td></tr><tr><td>netbeansify</td><td>netbeans.py</td><td>ç”Ÿæˆnetbeansé…ç½®æ–‡ä»¶</td></tr><tr><td>precompile</td><td>precompile.py</td><td>é¢„ç¼–è¯‘</td></tr><tr><td>secret</td><td>secret.py</td><td>ç”Ÿæˆsecret key</td></tr><tr><td>status</td><td>status.py</td><td>æ˜¾ç¤ºè¿è¡Œä¸­é¡¹ç›®çš„çŠ¶æ€</td></tr><tr><td>version</td><td>version.py</td><td>æ˜¾ç¤ºplay frameworkçš„ç‰ˆæœ¬å·</td></tr><tr><td>war</td><td>war.py</td><td>å°†é¡¹ç›®æ‰“åŒ…ä¸ºwaræ–‡ä»¶</td></tr></tbody></table><h3 id=runä¸start>runä¸start<a hidden class=anchor aria-hidden=true href=#runä¸start>#</a></h3><p>runåº”è¯¥æ˜¯æˆ‘ä»¬å¹³æ—¶ç”¨çš„æœ€å¤šçš„å‘½ä»¤äº†ï¼Œrunå‘½ä»¤çš„ä½œç”¨å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯æ ¹æ®å‘½ä»¤å‚æ•°æ‹¼æ¥javaå‚æ•°ï¼Œç„¶åè°ƒç”¨javaæ¥è¿è¡Œplay.server.Serverï¼Œrunå‡½æ•°çš„ä»£ç å¦‚ä¸‹:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run</span>(app, args):
</span></span><span style=display:flex><span>    <span style=color:#75715e>#appå³ä¸ºplayè„šæœ¬ä¸­åˆ›å»ºçš„PlayApplicationç±»</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> process
</span></span><span style=display:flex><span>    <span style=color:#75715e>#è¿™é‡Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨conf/routeså’Œconf/application.conf</span>
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>check()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print <span style=color:#e6db74>&#34;~ Ctrl+C to stop&#34;</span>
</span></span><span style=display:flex><span>    print <span style=color:#e6db74>&#34;~ &#34;</span>
</span></span><span style=display:flex><span>    java_cmd <span style=color:#f92672>=</span> app<span style=color:#f92672>.</span>java_cmd(args)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        process <span style=color:#f92672>=</span> subprocess<span style=color:#f92672>.</span>Popen (java_cmd, env<span style=color:#f92672>=</span>os<span style=color:#f92672>.</span>environ)
</span></span><span style=display:flex><span>        signal<span style=color:#f92672>.</span>signal(signal<span style=color:#f92672>.</span>SIGTERM, handle_sigterm)
</span></span><span style=display:flex><span>        return_code <span style=color:#f92672>=</span> process<span style=color:#f92672>.</span>wait()
</span></span><span style=display:flex><span>    signal<span style=color:#f92672>.</span>signal(signal<span style=color:#f92672>.</span>SIGINT, handle_sigint)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>!=</span> return_code:
</span></span><span style=display:flex><span>            sys<span style=color:#f92672>.</span>exit(return_code)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>OSError</span>:
</span></span><span style=display:flex><span>        print <span style=color:#e6db74>&#34;Could not execute the java executable, please make sure the JAVA_HOME environment variable is set properly (the java executable should reside at JAVA_HOME/bin/java). &#34;</span>
</span></span><span style=display:flex><span>        sys<span style=color:#f92672>.</span>exit(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    print
</span></span></code></pre></div><p>app.java_cmd(args)çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>java_cmd</span>(self, java_args, cp_args<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>, className<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;play.server.Server&#39;</span>, args <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        args <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;&#39;</span>]
</span></span><span style=display:flex><span>    memory_in_args<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#æ£€æŸ¥javaå‚æ•°ä¸­æ˜¯å¦æœ‰jvmå†…å­˜è®¾ç½®</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> arg <span style=color:#f92672>in</span> java_args:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> arg<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;-Xm&#39;</span>):
</span></span><span style=display:flex><span>            memory_in_args<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#å¦‚æœå‚æ•°ä¸­æ— jvmå†…å­˜è®¾ç½®ï¼Œé‚£ä¹ˆåœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾æ˜¯å¦æœ‰jvmå†…å­˜è®¾ç½®ï¼Œè‹¥è¿˜æ˜¯æ²¡æœ‰åˆ™åœ¨ç¯å¢ƒå˜é‡ä¸­æ‰¾æ˜¯å¦æœ‰JAVA_OPTS</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#è¿™é‡Œå…¶å®æœ‰ä¸ªé—®é¢˜ï¼Œè¿™é‡Œå‡å®šçš„æ˜¯JAVA_OPTSå˜é‡é‡Œåªå­˜äº†jvmå†…å­˜è®¾ç½®ï¼Œå¦‚æœJAVA_OPTSè¿˜å­˜äº†å…¶ä»–é€‰é¡¹ï¼Œé‚£å¯¹è¿è¡Œå¯èƒ½æœ‰å½±å“</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> memory_in_args:
</span></span><span style=display:flex><span>        memory <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>readConf(<span style=color:#e6db74>&#39;jvm.memory&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> memory:
</span></span><span style=display:flex><span>            java_args <span style=color:#f92672>=</span> java_args <span style=color:#f92672>+</span> memory<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> <span style=color:#e6db74>&#39;JAVA_OPTS&#39;</span> <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>environ:
</span></span><span style=display:flex><span>            java_args <span style=color:#f92672>=</span> java_args <span style=color:#f92672>+</span> os<span style=color:#f92672>.</span>environ[<span style=color:#e6db74>&#39;JAVA_OPTS&#39;</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>#è·å–ç¨‹åºçš„classpath</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> cp_args <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        cp_args <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>cp_args()
</span></span><span style=display:flex><span>    <span style=color:#75715e>#è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„jpdaç«¯å£</span>
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>jpda_port <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>readConf(<span style=color:#e6db74>&#39;jpda.port&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>#è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„è¿è¡Œæ¨¡å¼</span>
</span></span><span style=display:flex><span>    application_mode <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>readConf(<span style=color:#e6db74>&#39;application.mode&#39;</span>)<span style=color:#f92672>.</span>lower()
</span></span><span style=display:flex><span>    <span style=color:#75715e>#å¦‚æœæ¨¡å¼æ˜¯prodï¼Œåˆ™ç”¨serveræ¨¡å¼ç¼–è¯‘</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> application_mode <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;prod&#39;</span>:
</span></span><span style=display:flex><span>        java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-server&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># JDK 7 compat</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ä½¿ç”¨æ–°classæ ¡éªŒå™¨ (ä¸çŸ¥é“ä½œç”¨)</span>
</span></span><span style=display:flex><span>    java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-XX:-UseSplitVerifier&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>#æŸ¥æ‰¾é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦æœ‰javaå®‰å…¨é…ç½®ï¼Œå¦‚æœæœ‰åˆ™åŠ å…¥javaå‚æ•°ä¸­</span>
</span></span><span style=display:flex><span>    java_policy <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>readConf(<span style=color:#e6db74>&#39;java.policy&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> java_policy <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>:
</span></span><span style=display:flex><span>        policyFile <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(self<span style=color:#f92672>.</span>path, <span style=color:#e6db74>&#39;conf&#39;</span>, java_policy)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(policyFile):
</span></span><span style=display:flex><span>            print <span style=color:#e6db74>&#34;~ using policy file </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>%s</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> policyFile
</span></span><span style=display:flex><span>            java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-Djava.security.manager&#39;</span>)
</span></span><span style=display:flex><span>            java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-Djava.security.policy==</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> policyFile)
</span></span><span style=display:flex><span>    <span style=color:#75715e>#åŠ å…¥httpç«¯å£è®¾ç½®</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>play_env<span style=color:#f92672>.</span>has_key(<span style=color:#e6db74>&#39;http.port&#39;</span>):
</span></span><span style=display:flex><span>        args <span style=color:#f92672>+=</span> [<span style=color:#e6db74>&#34;--http.port=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>play_env[<span style=color:#e6db74>&#39;http.port&#39;</span>]]
</span></span><span style=display:flex><span>    <span style=color:#75715e>#åŠ å…¥httpsç«¯å£è®¾ç½®</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>play_env<span style=color:#f92672>.</span>has_key(<span style=color:#e6db74>&#39;https.port&#39;</span>):
</span></span><span style=display:flex><span>        args <span style=color:#f92672>+=</span> [<span style=color:#e6db74>&#34;--https.port=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>play_env[<span style=color:#e6db74>&#39;https.port&#39;</span>]]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#è®¾ç½®æ–‡ä»¶ç¼–ç </span>
</span></span><span style=display:flex><span>    java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-Dfile.encoding=utf-8&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>#è®¾ç½®ç¼–è¯‘å‘½ä»¤ (è¿™è¾¹ä½¿ç”¨äº†jregex/Pretokenizerç±»çš„nextæ–¹æ³•ï¼Œä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨)</span>
</span></span><span style=display:flex><span>    java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-XX:CompileCommand=exclude,jregex/Pretokenizer,next&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#å¦‚æœç¨‹åºæ¨¡å¼åœ¨devï¼Œåˆ™æ·»åŠ jpdaè°ƒè¯•å™¨å‚æ•°</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>readConf(<span style=color:#e6db74>&#39;application.mode&#39;</span>)<span style=color:#f92672>.</span>lower() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;dev&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>play_env[<span style=color:#e6db74>&#34;disable_check_jpda&#34;</span>]: self<span style=color:#f92672>.</span>check_jpda()
</span></span><span style=display:flex><span>        java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-Xdebug&#39;</span>)
</span></span><span style=display:flex><span>        java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-Xrunjdwp:transport=dt_socket,address=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>,server=y,suspend=n&#39;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>jpda_port)
</span></span><span style=display:flex><span>        java_args<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#39;-Dplay.debug=yes&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>#æ‹¼æ¥javaå‚æ•°</span>
</span></span><span style=display:flex><span>    java_cmd <span style=color:#f92672>=</span> [self<span style=color:#f92672>.</span>java_path(), <span style=color:#e6db74>&#39;-javaagent:</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>agent_path()] <span style=color:#f92672>+</span> java_args <span style=color:#f92672>+</span> [<span style=color:#e6db74>&#39;-classpath&#39;</span>, cp_args, <span style=color:#e6db74>&#39;-Dapplication.path=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>path, <span style=color:#e6db74>&#39;-Dplay.id=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>play_env[<span style=color:#e6db74>&#34;id&#34;</span>], className] <span style=color:#f92672>+</span> args
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> java_cmd
</span></span></code></pre></div><p>startå‘½ä»¤ä¸runå‘½ä»¤å¾ˆç±»ä¼¼ï¼Œæ‰§è¡Œæ­¥éª¤ä¸ºï¼š</p><ol><li>ä¾æ¬¡æŸ¥æ‰¾playå˜é‡pid_fileã€ç³»ç»Ÿç¯å¢ƒå˜é‡PLAY_PID_PATHã€é¡¹ç›®æ ¹ç›®å½•ä¸‹server.pidï¼ŒæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨æŒ‡å®špid</li><li>è‹¥ç¬¬ä¸€æ­¥æ‰¾åˆ°pidï¼ŒæŸ¥æ‰¾å½“å‰è¿›ç¨‹åˆ—è¡¨ä¸­æ˜¯å¦å­˜åœ¨æ­¤pidè¿›ç¨‹ï¼Œå­˜åœ¨åˆ™è¯•å›¾å…³é—­è¿›ç¨‹ã€‚(å¦‚æœæ­¤æ—¶pidå·²ç»ä¸æ˜¯playçš„è¿›ç¨‹å‘¢ğŸ˜…)</li><li>åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾application.log.system.outçœ‹æ˜¯å¦å…³é—­äº†ç³»ç»Ÿè¾“å‡º</li><li>å¯åŠ¨ç¨‹åºï¼Œè¿™é‡Œä¸runå‘½ä»¤å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä»–æŒ‡å®šäº†stdoutä½ç½®ï¼Œè¿™æ ·å°±å˜æˆäº†åå°ç¨‹åº</li><li>å°†å¯åŠ¨åçš„ç¨‹åºçš„pidå†™å…¥server.pid</li></ol><p>stopå‘½ä»¤å³å…³é—­å½“å‰è¿›ç¨‹ï¼Œè¿™é‡Œè¦æä¸€ä¸‹ï¼Œplayæœ‰ä¸ªæ³¨è§£å«OnApplicationStopï¼Œå³ä¼šåœ¨ç¨‹åºåœæ­¢æ—¶è§¦å‘ï¼Œè€ŒOnApplicationStopçš„å®ç°ä¸»è¦æ˜¯è°ƒç”¨äº†</p><blockquote><p>Runtime.getRuntime().addShutdownHook();</p></blockquote><p>æ¥å®Œæˆ</p><h3 id=testä¸autotest>testä¸autotest<a hidden class=anchor aria-hidden=true href=#testä¸autotest>#</a></h3><p>ä½¿ç”¨play testå‘½ä»¤å¯ä»¥è®©ç¨‹åºè¿›å…¥æµ‹è¯•æ¨¡å¼ï¼Œtestå‘½ä»¤å’Œrunå‘½ä»¤å…¶å®å·®åˆ«ä¸å¤§ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±åœ¨äºä½¿ç”¨testå‘½ä»¤æ—¶ï¼Œè„šæœ¬ä¼šå°†play idè‡ªåŠ¨æ›¿æ¢ä¸ºtestï¼Œå½“play idä¸ºtestæ—¶ä¼šè‡ªåŠ¨å¼•å…¥testrunneræ¨¡å—ï¼Œtestrunneræ¨¡å—ä¸»è¦åŠŸèƒ½ä¸ºæ·»åŠ @testsè·¯ç”±å¹¶å®ç°äº†testæµ‹è¯•é¡µé¢ï¼Œä»–çš„å…·ä½“å®ç°è¿‡ç¨‹åç»­å†è°ˆã€‚
autotestå‘½ä»¤çš„ä½œç”¨æ˜¯è‡ªåŠ¨æµ‹è¯•æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ï¼Œä»–çš„æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š</p><ol><li>æ£€æŸ¥æ˜¯å¦å­˜åœ¨tmpæ–‡ä»¶å¤¹ï¼Œå­˜åœ¨å³åˆ é™¤</li><li>æ£€æŸ¥æ˜¯å¦æœ‰ç¨‹åºæ­£åœ¨è¿è¡Œï¼Œå¦‚å­˜åœ¨åˆ™å…³é—­ç¨‹åº</li><li>æ£€æŸ¥ç¨‹åºæ˜¯å¦é…ç½®äº†sslä½†æ˜¯æ²¡æœ‰æŒ‡å®šè¯ä¹¦</li><li>æ£€æŸ¥æ˜¯å¦å­˜åœ¨test-resultæ–‡ä»¶å¤¹ï¼Œå­˜åœ¨å³åˆ é™¤</li><li>ä½¿ç”¨testä½œä¸ºidé‡å¯ç¨‹åº</li><li>è°ƒç”¨play.modules.testrunner.FirePhoqueæ¥è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•</li><li>å…³é—­ç¨‹åº</li></ol><p>autotestçš„è„šæœ¬çš„æ­¥éª¤1å’Œ2æˆ‘è§‰å¾—æ˜¯æœ‰é—®é¢˜çš„ï¼Œåº”è¯¥æ¢ä¸‹é¡ºåºï¼Œä¸ç„¶å¦‚æœç¨‹åºæ­£åœ¨å‘tmpæ–‡ä»¶å¤¹æ’å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œé‚£ä¹ˆtmpæ–‡ä»¶å¤¹å°±åˆ é™¤å¤±è´¥äº†ã€‚
å…³é—­ç¨‹åºçš„ä»£ç è°ƒç”¨äº†<code>http://localhost:%http_port/@kill</code>è¿›è¡Œå…³é—­ï¼Œ@killçš„å®ç°æ–¹æ³•åœ¨play.CorePluginä¸‹ï¼Œæ³¨æ„ï¼Œ@killåœ¨prodæ¨¡å¼ä¸‹æ— æ•ˆ (<del>è¿™æ˜¯åºŸè¯</del>)<br>ç”±äºä½¿ç”¨äº†pythonä½œä¸ºå¯åŠ¨è„šæœ¬ï¼Œæ— æ³•é€šè¿‡javaå†…éƒ¨å˜é‡å€¼åˆ¤æ–­ç¨‹åºæ˜¯å¦å¼€å¯ï¼Œåªèƒ½æŸ¥çœ‹æ§åˆ¶å°çš„è¾“å‡ºæ—¥å¿—ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨testä½œä¸ºidé‡å¯åï¼Œè„šæœ¬ä½¿ç”¨ä¸‹é¢çš„ä»£ç åˆ¤æ–­ç¨‹åºæ˜¯å¦å®Œå…¨å¯åŠ¨ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e>#è¿™é‡Œå¯åŠ¨ç¨‹åº</span>
</span></span><span style=display:flex><span>    play_process <span style=color:#f92672>=</span> subprocess<span style=color:#f92672>.</span>Popen(java_cmd, env<span style=color:#f92672>=</span>os<span style=color:#f92672>.</span>environ, stdout<span style=color:#f92672>=</span>sout)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>OSError</span>:
</span></span><span style=display:flex><span>        print <span style=color:#e6db74>&#34;Could not execute the java executable, please make sure the JAVA_HOME environment variable is set properly (the java executable should reside at JAVA_HOME/bin/java). &#34;</span>
</span></span><span style=display:flex><span>        sys<span style=color:#f92672>.</span>exit(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>#æ‰“å¼€æ—¥å¿—è¾“å‡ºæ–‡ä»¶</span>
</span></span><span style=display:flex><span>    soutint <span style=color:#f92672>=</span> open(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(app<span style=color:#f92672>.</span>log_path(), <span style=color:#e6db74>&#39;system.out&#39;</span>), <span style=color:#e6db74>&#39;r&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> play_process<span style=color:#f92672>.</span>poll():
</span></span><span style=display:flex><span>            print <span style=color:#e6db74>&#34;~&#34;</span>
</span></span><span style=display:flex><span>            print <span style=color:#e6db74>&#34;~ Oops, application has not started?&#34;</span>
</span></span><span style=display:flex><span>            print <span style=color:#e6db74>&#34;~&#34;</span>
</span></span><span style=display:flex><span>            sys<span style=color:#f92672>.</span>exit(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        line <span style=color:#f92672>=</span> soutint<span style=color:#f92672>.</span>readline()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line:
</span></span><span style=display:flex><span>            print line
</span></span><span style=display:flex><span>            <span style=color:#75715e>#è‹¥å‡ºç°&#39;Server is up and running&#39;åˆ™æ­£å¸¸å¯åŠ¨</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> line<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;Server is up and running&#39;</span>) <span style=color:#f92672>&gt;</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>: <span style=color:#75715e># This line is written out by Server.java to system.out and is not log file dependent</span>
</span></span><span style=display:flex><span>                soutint<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><p>FirePhoqueç±»çš„å®ç°è¿‡ç¨‹æˆ‘ä»¬ä¹‹åå†è¯¦è§£ã€‚</p><h3 id=newä¸clean>newä¸clean<a hidden class=anchor aria-hidden=true href=#newä¸clean>#</a></h3><p>æˆ‘ä»¬ä½¿ç”¨newæ¥åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œplay newçš„ä½¿ç”¨æ–¹æ³•ä¸º<code>play new project-name [--with] [--name]</code>ã€‚
withå‚æ•°ä¸ºé¡¹ç›®æ‰€ä½¿ç”¨çš„æ¨¡å—ã€‚
nameä¸ºé¡¹ç›®åï¼Œè¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ï¼Œproject-nameå’Œ&ndash;nameçš„å‚æ•°å¯ä»¥è®¾ç½®ä¸ºä¸åŒå€¼ï¼Œproject-nameæ˜¯é¡¹ç›®å»ºç«‹çš„æ–‡ä»¶å¤¹åï¼Œ&ndash;nameçš„å€¼ä¸ºé¡¹ç›®é…ç½®æ–‡ä»¶ä¸­çš„application.nameã€‚<br>å¦‚æœä¸åŠ &ndash;nameï¼Œè„šæœ¬ä¼šæç¤ºä½ æ˜¯å¦ä½¿ç”¨project-nameä½œä¸ºåå­—ï¼Œåœ¨ç¡®è®¤ä¹‹åï¼Œè„šæœ¬ä¼šå°†resources/application-skelä¸­çš„æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ°{project-name}æ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åç”¨è¾“å…¥çš„nameæ›¿æ¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸‹çš„application.nameï¼Œå¹¶ç”Ÿæˆä¸€ä¸ª64ä½çš„secretKeyæ›¿æ¢é…ç½®æ–‡ä»¶ä¸­çš„secretKeyã€‚<br>æ¥ç€ï¼Œè„šæœ¬ä¼šæŸ¥æ‰¾ä½¿ç”¨çš„æ¨¡å—ä¸­æ˜¯å¦å­˜åœ¨dependencies.ymlï¼Œå¹¶å°†dependencies.ymlä¸­çš„å†…å®¹åŠ å…¥é¡¹ç›®çš„dependencies.ymlä¸­ï¼Œå¹¶è°ƒç”¨DependenciesManageræ£€æŸ¥ä¾èµ–çŠ¶æ€ã€‚</p><p>newå‡½æ•°çš„ä¸»è¦ä»£ç å¦‚ä¸‹:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>print <span style=color:#e6db74>&#34;~ The new application will be created in </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>normpath(app<span style=color:#f92672>.</span>path)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> application_name <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>    application_name <span style=color:#f92672>=</span> raw_input(<span style=color:#e6db74>&#34;~ What is the application name? [</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>] &#34;</span> <span style=color:#f92672>%</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>basename(app<span style=color:#f92672>.</span>path))
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> application_name <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span>:
</span></span><span style=display:flex><span>    application_name <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>basename(app<span style=color:#f92672>.</span>path)
</span></span><span style=display:flex><span>copy_directory(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(env[<span style=color:#e6db74>&#34;basedir&#34;</span>], <span style=color:#e6db74>&#39;resources/application-skel&#39;</span>), app<span style=color:#f92672>.</span>path)
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>mkdir(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(app<span style=color:#f92672>.</span>path, <span style=color:#e6db74>&#39;app/models&#39;</span>))
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>mkdir(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(app<span style=color:#f92672>.</span>path, <span style=color:#e6db74>&#39;lib&#39;</span>))
</span></span><span style=display:flex><span>app<span style=color:#f92672>.</span>check()
</span></span><span style=display:flex><span>replaceAll(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(app<span style=color:#f92672>.</span>path, <span style=color:#e6db74>&#39;conf/application.conf&#39;</span>), <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;%APPLICATION_NAME%&#39;</span>, application_name)
</span></span><span style=display:flex><span>replaceAll(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(app<span style=color:#f92672>.</span>path, <span style=color:#e6db74>&#39;conf/application.conf&#39;</span>), <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;%SECRET_KEY%&#39;</span>, secretKey())
</span></span><span style=display:flex><span>print <span style=color:#e6db74>&#34;~&#34;</span>
</span></span></code></pre></div><p>cleanå‘½ä»¤éå¸¸ç®€å•ï¼Œå°±æ˜¯åˆ é™¤æ•´ä¸ªtmpæ–‡ä»¶å¤¹</p><h3 id=warä¸precompile>warä¸precompile<a hidden class=anchor aria-hidden=true href=#warä¸precompile>#</a></h3><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨tomcatç­‰æœåŠ¡å™¨å®¹å™¨ä½œä¸ºæœåŠ¡è½½ä½“ï¼Œè¿™æ—¶å€™å°±éœ€è¦å°†playåº”ç”¨æ‰“åŒ…ä¸ºwar<br>warçš„ä½¿ç”¨å‚æ•°æ˜¯</p><blockquote><p>play war project-name [-o/&ndash;output][filename] [&ndash;zip] [&ndash;exclude][exclude-directories]</p></blockquote><p>ä½¿ç”¨-oæˆ–&ndash;outputæ¥æŒ‡å®šè¾“å‡ºæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨&ndash;zipå‹ç¼©ä¸ºwaræ ¼å¼ï¼Œä½¿ç”¨&ndash;excludeæ¥åŒ…å«å¦å¤–éœ€è¦æ‰“åŒ…çš„æ–‡ä»¶å¤¹<br>è¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»åœ¨é¡¹ç›®ç›®å½•å¤–è¿›è¡Œæ“ä½œï¼Œä¸ç„¶ä¼šå¤±è´¥</p><p>åœ¨å‚æ•°å¤„ç†å®Œæ¯•åï¼Œè„šæœ¬æ­£å¼å¼€å§‹æ‰“åŒ…è¿‡ç¨‹ï¼Œåˆ†ä¸º2ä¸ªæ­¥éª¤ï¼š1.é¢„ç¼–è¯‘ã€‚2ï¼šæ‰“åŒ…</p><p>é¢„ç¼–è¯‘å³ç”¨åˆ°äº†precompileå‘½ä»¤ï¼Œprecompileå‘½ä»¤ä¸runå‘½ä»¤å‡ ä¹ä¸€æ ·ï¼Œåªæ˜¯åœ¨javaå‚æ•°ä¸­åŠ å…¥äº†<code>precompile=yes</code><br>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åŠ å…¥äº†è¿™ä¸ªjavaå‚æ•°å¯¹ç¨‹åºçš„å½±å“ã€‚
ä¸é¢„ç¼–è¯‘æœ‰å…³çš„ä»£ç ä¸»è¦æ˜¯ä¸‹é¢2æ®µï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>preCompile</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (usePrecompiled) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (Play.<span style=color:#a6e22e>getFile</span>(<span style=color:#e6db74>&#34;precompiled&#34;</span>).<span style=color:#a6e22e>exists</span>()) {
</span></span><span style=display:flex><span>            classloader.<span style=color:#a6e22e>getAllClasses</span>();
</span></span><span style=display:flex><span>            Logger.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;Application is precompiled&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        Logger.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#34;Precompiled classes are missing!!&#34;</span>);
</span></span><span style=display:flex><span>        fatalServerErrorOccurred();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>//è¿™é‡Œå¼€å§‹é¢„ç¼–è¯‘</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        Logger.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;Precompiling ...&#34;</span>);
</span></span><span style=display:flex><span>        Thread.<span style=color:#a6e22e>currentThread</span>().<span style=color:#a6e22e>setContextClassLoader</span>(Play.<span style=color:#a6e22e>classloader</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>long</span> start <span style=color:#f92672>=</span> System.<span style=color:#a6e22e>currentTimeMillis</span>();
</span></span><span style=display:flex><span>        <span style=color:#75715e>//getAllClassesæ–¹æ³•è¾ƒé•¿ï¼Œå°±ä¸è´´äº†ï¼Œä¸‹é¢ä¸€æ®µä»£ç åœ¨getAllClassesæ–¹æ³•ä¸­è¿›å…¥</span>
</span></span><span style=display:flex><span>        classloader.<span style=color:#a6e22e>getAllClasses</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (Logger.<span style=color:#a6e22e>isTraceEnabled</span>()) {
</span></span><span style=display:flex><span>            Logger.<span style=color:#a6e22e>trace</span>(<span style=color:#e6db74>&#34;%sms to precompile the Java stuff&#34;</span>, System.<span style=color:#a6e22e>currentTimeMillis</span>() <span style=color:#f92672>-</span> start);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>lazyLoadTemplates) {
</span></span><span style=display:flex><span>            start <span style=color:#f92672>=</span> System.<span style=color:#a6e22e>currentTimeMillis</span>();
</span></span><span style=display:flex><span>            <span style=color:#75715e>//ç¼–è¯‘æ¨¡æ¿</span>
</span></span><span style=display:flex><span>            TemplateLoader.<span style=color:#a6e22e>getAllTemplate</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (Logger.<span style=color:#a6e22e>isTraceEnabled</span>()) {
</span></span><span style=display:flex><span>                Logger.<span style=color:#a6e22e>trace</span>(<span style=color:#e6db74>&#34;%sms to precompile the templates&#34;</span>, System.<span style=color:#a6e22e>currentTimeMillis</span>() <span style=color:#f92672>-</span> start);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (Throwable e) {
</span></span><span style=display:flex><span>        Logger.<span style=color:#a6e22e>error</span>(e, <span style=color:#e6db74>&#34;Cannot start in PROD mode with errors&#34;</span>);
</span></span><span style=display:flex><span>        fatalServerErrorOccurred();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>enhance</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>enhancedByteCode</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>javaByteCode</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (isClass()) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// before we can start enhancing this class we must make sure it is not a PlayPlugin.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// PlayPlugins can be included as regular java files in a Play-application.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If a PlayPlugin is present in the application, it is loaded when other plugins are loaded.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// All plugins must be loaded before we can start enhancing.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// This is a problem when loading PlayPlugins bundled as regular app-class since it uses the same classloader</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// as the other (soon to be) enhanched play-app-classes.</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>boolean</span> shouldEnhance <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            CtClass ctClass <span style=color:#f92672>=</span> enhanceChecker_classPool.<span style=color:#a6e22e>makeClass</span>(<span style=color:#66d9ef>new</span> ByteArrayInputStream(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>enhancedByteCode</span>));
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (ctClass.<span style=color:#a6e22e>subclassOf</span>(ctPlayPluginClass)) {
</span></span><span style=display:flex><span>                shouldEnhance <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span>( Exception e) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// nop</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (shouldEnhance) {
</span></span><span style=display:flex><span>            Play.<span style=color:#a6e22e>pluginCollection</span>.<span style=color:#a6e22e>enhance</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//ä¸»è¦æ˜¯è¿™ä¸€æ®µï¼Œä»–å°†å¢å¼ºå¤„ç†åçš„å­—èŠ‚ç å†™å…¥äº†æ–‡ä»¶ï¼Œå¢å¼ºå¤„ç†åœ¨ä¹‹åä¼šæ·±å…¥å±•å¼€</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (System.<span style=color:#a6e22e>getProperty</span>(<span style=color:#e6db74>&#34;precompile&#34;</span>) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// emit bytecode to standard class layout as well</span>
</span></span><span style=display:flex><span>            File f <span style=color:#f92672>=</span> Play.<span style=color:#a6e22e>getFile</span>(<span style=color:#e6db74>&#34;precompiled/java/&#34;</span> <span style=color:#f92672>+</span> (name.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>&#34;.&#34;</span>, <span style=color:#e6db74>&#34;/&#34;</span>)) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.class&#34;</span>);
</span></span><span style=display:flex><span>            f.<span style=color:#a6e22e>getParentFile</span>().<span style=color:#a6e22e>mkdirs</span>();
</span></span><span style=display:flex><span>            FileOutputStream fos <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileOutputStream(f);
</span></span><span style=display:flex><span>            fos.<span style=color:#a6e22e>write</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>enhancedByteCode</span>);
</span></span><span style=display:flex><span>            fos.<span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception e) {
</span></span><span style=display:flex><span>            e.<span style=color:#a6e22e>printStackTrace</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>enhancedByteCode</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>é¢„ç¼–è¯‘è¿‡ç¨‹ç»“æŸåï¼Œè„šæœ¬æ­£å¼å¼€å§‹æ‰“åŒ…è¿‡ç¨‹ï¼Œæ‰“åŒ…è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯è®²é¢„ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ã€æ¨¡æ¿æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€ä½¿ç”¨çš„ç±»åº“ã€ä½¿ç”¨çš„æ¨¡å—ç±»åº“ç­‰ç§»åŠ¨è‡³WEB-INFæ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœä½¿ç”¨äº†&ndash;zipï¼Œé‚£ä¹ˆè„šæœ¬ä¼šå°†ç”Ÿæˆçš„æ–‡ä»¶å¤¹ç”¨zipæ ¼å¼æ‰“åŒ…ã€‚</p><h3 id=secretå’Œstatus>secretå’Œstatus<a hidden class=anchor aria-hidden=true href=#secretå’Œstatus>#</a></h3><p>secretå‘½ä»¤èƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„secret key
statuså‘½ä»¤æ˜¯ç”¨äºå®æ—¶æ˜¾ç¤ºç¨‹åºçš„è¿è¡ŒçŠ¶æ€ï¼Œè„šæœ¬çš„è¿ä½œååˆ†ç®€å•ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>æ£€æŸ¥æ˜¯å¦æœ‰&ndash;urlå‚æ•°ï¼Œæœ‰åˆ™åœ¨ä»–ä¹‹åæ·»åŠ @status</li><li>æ£€æŸ¥æ˜¯å¦å­˜åœ¨&ndash;secret</li><li>å¦‚æœæ²¡æœ‰&ndash;urlï¼Œåˆ™ä½¿ç”¨<code>http://localhost:%http_port/@status</code>;å¦‚æœæ²¡æœ‰ &ndash;secretï¼Œåˆ™ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–secret key</li><li>å°†secret_keyã€&rsquo;@status&rsquo;ä½¿ç”¨shaåŠ å¯†ï¼Œå¹¶åŠ å…¥Authorizationè¯·æ±‚å¤´</li><li>å‘é€è¯·æ±‚</li></ol><p>@statusçš„å®ç°å’Œ@killä¸€æ ·åœ¨CorePluginç±»ä¸­ï¼Œè¿™åœ¨ä¹‹åå†è¿›è¡Œè¯¦è§£ã€‚</p><h1 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h1><p>Playçš„å¯åŠ¨è„šæœ¬åˆ†æè‡³æ­¤å°±ç»“æŸäº†ï¼Œä»è„šæœ¬çš„åˆ†æè¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥ç¨å¾®æ¢ç©¶ä¸‹Playåœ¨è„šæœ¬å¯åŠ¨é˜¶æ®µæœ‰ä½•è¡Œä¸ºï¼Œè¿™å¯¹æˆ‘ä»¬è¿›è¡Œè„šæœ¬æ”¹é€ æˆ–è€…å¯åŠ¨ä¼˜åŒ–è¿˜æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚
ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹Playçš„å¯åŠ¨ç±»æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://example.org/tags/program/>Program</a></li><li><a href=https://example.org/tags/backend/>Backend</a></li></ul><nav class=paginav><a class=prev href=https://example.org/posts/play-framework/part2server%E4%B8%8Eservletwrapper/><span class=title>Â« Prev</span><br><span>Play frameworkæºç è§£æ Part2:Serverä¸ServletWrapper</span>
</a><a class=next href=https://example.org/posts/play-framework/play-framework%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%9B%AE%E5%BD%95/><span class=title>Next Â»</span><br><span>Play frameworkæºç è§£æç›®å½•</span></a></nav></footer><script src=https://utteranc.es/client.js repo=asukaonly/asukaonly.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://example.org/>404 NOT FOUND</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>