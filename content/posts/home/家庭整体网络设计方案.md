+++
title = '家庭整体网络设计方案'
date = 2025-02-09 20:09:05
tags = ["home"]
categories = ["home"]
+++

# 写在最前
早在毕业后的租房时期，就时常期待有了自己的家后要进行怎么样的网络改造，每次看网上博主各种内网万兆传输、服务器机柜、nas整列等等都心生羡慕，在2023年新家入住后的2年内，针对家庭网络的改造一直断断续续的持续进行中，在2年后的2025年，感觉也算完成了当前阶段的一个目标了，是时候写一点东西总结一下相关的内容了。决定按以下内容分别理一下我组建家庭网络的心得。

1. 家庭整体网络设计方案
2. 软路由方案
3. 家庭服务器方案
4. 智能家居方案

这篇我着重聊一下这2年家庭网络结构的发展过程及心路历程。

# 房屋结构和网络需求
由于房屋是精装交付，成本考虑在入住装修时没有进行大幅结构改造（这也给后续改造带来了种种问题😭），简略结构图如下：

![](/img/家庭网络/房屋结构.png)

入住前暴露的主要问题有以下几点：

1. 弱电箱嵌入在进门鞋柜内，内部空间非常有限，没法塞入很多网络设备，且散热不好。
2. 网口较少，无线AP只能放置在客厅的位置，书房会存在一定的wifi死角。
3. 装修内置的是超5类网线，虽短距能上万兆，但稳定性受影响。

而我对家庭网络能力的主要需求如下：
| 需求              | 必要性 | 备注 |
| ---------        | ----------- | ----------- |
| 全屋透明代理       | ⭐⭐⭐⭐⭐       | 满足全屋代理的同时，需要过滤pt流量/大陆域名请求等
| 内网2.5G速率      | ⭐⭐⭐⭐⭐        | 综合考虑，部署万兆的成本过高，日常使用2.5G已够使用
| 内网穿透          | ⭐⭐⭐⭐          | 游戏联机/家庭相册共享需要
| 支持内网私有域名    | ⭐⭐⭐⭐         | 简化日常内网部署应用的使用
| 网络监控/恢复能力   | ⭐⭐⭐          | 提升故障问题发现率
| 智能家居内网部署  | ⭐⭐              | 智能家居设备使用走内网提升速率并支持离线使用
| 隐私设备子网隔离 | ⭐⭐            | 摄像头、传感器类iot设备屏蔽公网
| 容灾能力          | ⭐             | 减少故障发生后的恢复时间

基于以上的需求，可以得到以下的初步结论
1. 由于需要全屋透明代理，故需要使用软路由做主路由的方案，这里我选用OpenWrt作为我的软路由系统。（个人不喜欢旁路由模式，不够透明也不够旁🐶）
2. 由于需要全屋2.5G速率，硬件上交换机/AP/设备网口均需要支持2.5G协商速率。（被只支持1G和10G的万兆卡坑过）
3. 由于需要内网穿透+私有域名等需求，需要软路由系统有相关的功能支持.(关注版本功能)
4. 由于需要智能家居内网部署，购买设备时需要关注是否支持zigbee/matter等协议。

# 2023：先跑起来

2023年的主题是建设，在入住后不久，我就开始陆陆续续购买了网络设备进行了网络改造，我的网络设备大概如下

## 主路由：零刻eq12
整体的硬件布置如下，可以看到我使用了单臂路由作为主路由的连接方案，

![](/img/家庭网络/2023-结构.png)




# 24年的改变

